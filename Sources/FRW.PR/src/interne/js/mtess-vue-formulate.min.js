var MtessVueFormulate=function(){"use strict";function e(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function t(t){for(var i=1;i<arguments.length;i++){var a=null!=arguments[i]?arguments[i]:{};i%2?e(Object(a),!0).forEach((function(e){o(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=s(e);if(t){var r=s(this).constructor;i=Reflect.construct(a,arguments,r)}else i=a.apply(this,arguments);return c(this,i)}}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var a,r,n=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function p(e,t,i,a,r,n,o,s,l,c){"boolean"!=typeof o&&(l=s,s=o,o=!1);const h="function"==typeof i?i.options:i;let u;if(e&&e.render&&(h.render=e.render,h.staticRenderFns=e.staticRenderFns,h._compiled=!0,r&&(h.functional=!0)),a&&(h._scopeId=a),n?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},h._ssrRegister=u):t&&(u=o?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),u)if(h.functional){const e=h.render;h.render=function(t,i){return u.call(i),e(t,i)}}else{const e=h.beforeCreate;h.beforeCreate=e?[].concat(e,u):[u]}return i}var f=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(e.tag,{tag:"component",class:["label",e.context.classes.label,e.tooltipText?"has-tooltip":""],attrs:{id:e.context.id+"_label",for:"label"===e.tag?e.context.id:null}},[e.tooltipText?[i("span",[e._v(e._s(e.labelSansDernierMot))]),e._v(" "),i("span",{staticClass:"conteneur-infobulle"},[i("span",[e._v(e._s(e.dernierMotLabel))]),e._v(" "),e.isRequired?i("span",{staticClass:"icone-champ-requis",attrs:{"aria-hidden":"true"}},[e._v(" "+e._s(e.requiredFieldIndicator))]):e._e(),e._v(" "),i("utd-infobulle",{attrs:{titre:e.tooltipTitle,srtitre:e.$t("accessibilite.textePrefixeTitreAideContextuelle"),srBoutonOuvrir:e.$t("accessibilite.btnAideContextuelle"),srBoutonFermer:e.$t("boutons.fermer")}},[i("div",{attrs:{slot:"contenu"},domProps:{innerHTML:e._s(e.tooltipText)},slot:"contenu"})])],1)]:[i("span",[e._v(e._s(e.context.label))]),e.isRequired?i("span",{staticClass:"icone-champ-requis",attrs:{"aria-hidden":"true"}},[e._v(" "+e._s(e.requiredFieldIndicator))]):e._e()],e._v(" "),e.isRequired?i("span",{staticClass:"sr-only"},[e._v(". "+e._s(e.$t("accessibilite.indicateurChampObligatoire")))]):e._e(),e._v(" "),e.hasValidationRules&&e.messagesErreur?i("span",{staticClass:"sr-only",attrs:{"aria-live":"polite"}},[e._v(" "+e._s(e.messagesErreur))]):e._e()],2)},staticRenderFns:[]},undefined,{props:{context:{type:Object,required:!0},tooltipTitle:{type:String,required:!1},tooltipText:{type:String,required:!1}},data:function(){return{id:null,isRequired:!1,requiredFieldIndicator:"",labelSansDernierMot:"",dernierMotLabel:""}},computed:{messagesErreur:function(){return this.context.visibleValidationErrors.join(" ")},tag:function(){return"group"!==this.context.classification||"radio"!==this.context.type&&"checkbox"!==this.context.type?"adresse"===this.context.type?"span":"label":"span"}},created:function(){if(this.hasValidationRules=this.context.rules.length>0,this.isRequired=this.context.rules.findIndex((function(e){return"required"===e.ruleName}))>=0,this.requiredFieldIndicator=this.isRequired?"*":"",this.context.help&&this.$nextTick((function(){var e=this.$parent.$el.querySelector(".formulate-input-help");e&&this.$el.setAttribute("aria-describedby",e.id)})),this.tooltipText){var e=this.context.label.lastIndexOf(" ");this.labelSansDernierMot=this.context.label.substring(0,e),this.dernierMotLabel=this.context.label.substring(e)}},mounted:function(){this.id=this._uid}},undefined,false,undefined,!1,void 0,void 0,void 0),m=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.visibleErrors.length>0||e.erreursChamp.length>0?i("div",["form"===e.type?i("div",{},[e.errorSummary.length>0?i("div",{staticClass:"validation-summary-errors",attrs:{"data-valmsg-summary":"true",tabindex:"-1"}},[i("utd-avis",{attrs:{type:"erreur",titre:e.$t("validations.enteteSommaireErreurs")}},[i("div",{attrs:{slot:"contenu"},slot:"contenu"},[i("ul",{class:e.outerClass},e._l(e.errorSummary,(function(t,a){return i("li",{key:a,class:e.itemClass,attrs:{role:e.role,"aria-live":e.ariaLive}},[i("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),e.setInputFocus(t.name)}}},[e._v(e._s(t.message))])])})),0)])])],1):e._e()]):i("div",[i("ul",{class:e.outerClass,attrs:{"aria-hidden":"true"}},e._l(e.erreursChamp,(function(t){return i("li",{key:t,class:e.itemClass,attrs:{role:e.role,"aria-live":e.ariaLive},domProps:{textContent:e._s(t)}})})),0)])]):e._e()},staticRenderFns:[]},undefined,{props:{visibleErrors:{type:Array,required:!0},itemClass:{type:[String,Array,Object,Boolean],default:!1},outerClass:{type:[String,Array,Object,Boolean],default:!1},role:{type:[String],default:"status"},ariaLive:{type:[String,Boolean],default:"polite"},type:{type:String,required:!0}},data:function(){return{erreursChamp:[]}},computed:{errorSummary:function(){return this.visibleErrors.length>0?JSON.parse(this.visibleErrors):[]}},watch:{visibleErrors:function(){setTimeout((function(e){e.erreursChamp=e.visibleErrors}),180,this)}},updated:function(){this.$nextTick((function(){if("form"===this.type&&this.$root.$el.getAttribute("data-submit")){this.$root.$el.removeAttribute("data-submit");var e=$(this.$el),t=e.closest("form"),i=e.find(".validation-summary-errors:first");t.length&&t.hasClass("no-error-summary")?(i.length&&i.addClass("d-none").attr("aria-hidden","true"),this.setInputFocus(this.errorSummary[0].name)):i.length&&i.get(0).focus()}}))},methods:{setInputFocus:function(e){var t=this;return setTimeout((function(e){var i=document.getElementsByName(e);if(i){var a=t.obtenirIdPage(i[0]),r=i[0].getAttribute("cle")||i[0].name;a?t.$root.effectuerNavigationParId(a,r):t.$root.donnerFocusControle(r,!1)}}),10,e),!1},obtenirIdPage:function(e){return $(e).parents(".section:first").attr("data-id-page")}}},undefined,false,undefined,!1,void 0,void 0,void 0),v=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.context.repeatable?i("div",{staticClass:"group-repeatable-remove-container"},[i("button",{staticClass:"utd-btn tertiaire",class:e.context.classes.groupRepeatableRemove,attrs:{type:"button","data-disabled":e.context.model.length<=e.context.minimum},domProps:{textContent:e._s(e.context.removeLabel)},on:{click:function(t){return t.preventDefault(),e.removeItem.apply(null,arguments)},keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.removeItem.apply(null,arguments)}}})]):e._e()},staticRenderFns:[]},undefined,{props:{index:{type:Number,default:null},context:{type:Object,required:!0},removeItem:{type:Function,required:!0}}},undefined,false,undefined,!1,void 0,void 0,void 0),g=v,b=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:[e.context.classes.groupRepeatable]},[i("div",{class:e.context.label?"contenu-extensible instance-groupe card section-secondaire":""},[i("div",{class:e.context.label?"card-title":""},[e.context.label?i("a",{attrs:{role:"button","data-toggle":"collapse","aria-expanded":"true",href:"#"+e.context.name+"-"+e.index,"aria-controls":e.context.name+"-"+e.index}},[i("span",{staticClass:"libelle",attrs:{id:"label"+e.context.name+"-"+e.index}},[i("span",{staticClass:"libelle-instance"},[e._v(e._s(e.instanceLabel||e.context.label)+" ")]),e._v(" "),e.context.repeatable?i("span",{staticClass:"numero"},[e._v(e._s(e.index+1))]):e._e()]),e._v(" "),i("span",{staticClass:"utd-icone-svg md chevron-haut-texte",attrs:{"aria-hidden":"true"}})]):e._e()]),e._v(" "),i("div",{staticClass:"collapse show",attrs:{id:e.context.name+"-"+e.index,role:e.context.label?"group":null,"aria-labelledby":e.context.label?"label"+e.context.name+"-"+e.index:null}},[i("div",{class:e.context.label?"card-body":""},["after"===e.context.removePosition?e._t("default"):e._e(),e._v(" "),i("FormulateSlot",{attrs:{name:"remove",context:e.context,index:e.index,"remove-item":e.removeItem}},[i(e.context.slotComponents.remove,e._b({tag:"component",attrs:{context:e.context,index:e.index,"remove-item":e.removeItem}},"component",e.context.slotProps.remove,!1))],1),e._v(" "),"before"===e.context.removePosition?e._t("default"):e._e()],2)])])])},staticRenderFns:[]},undefined,{props:{context:{type:Object,required:!0},removeItem:{type:Function,required:!0},index:{type:Number,required:!0},instanceLabel:{type:String,required:!1}},computed:{messagesErreur:function(){return this.context.visibleValidationErrors.join(" ")},tag:function(){return"group"!==this.context.classification||"radio"!==this.context.type&&"checkbox"!==this.context.type?"label":"span"}}},undefined,false,undefined,!1,void 0,void 0,void 0);
/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */
function x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?x(Object(i),!0).forEach((function(t){E(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var M="undefined"!=typeof window&&void 0!==window.document,F=M?window:{},I=!(!M||!F.document.documentElement)&&"ontouchstart"in F.document.documentElement,R=!!M&&"PointerEvent"in F,B="cropper",T="all",k="crop",O="move",P="zoom",L="e",S="w",U="s",N="n",j="ne",q="nw",H="se",W="sw",z="".concat(B,"-crop"),Y="".concat(B,"-disabled"),Q="".concat(B,"-hidden"),V="".concat(B,"-hide"),X="".concat(B,"-invisible"),G="".concat(B,"-modal"),K="".concat(B,"-move"),J="".concat(B,"Action"),Z="".concat(B,"Preview"),ee="crop",te="move",ie="none",ae="crop",re="cropend",ne="cropmove",oe="cropstart",se="dblclick",le=R?"pointerdown":I?"touchstart":"mousedown",ce=R?"pointermove":I?"touchmove":"mousemove",he=R?"pointerup pointercancel":I?"touchend touchcancel":"mouseup",ue="ready",de="resize",pe="wheel",fe="zoom",me="image/jpeg",ve=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,ge=/^data:/,be=/^data:image\/jpeg;base64,/,xe=/^img|canvas$/i,ye={viewMode:0,dragMode:ee,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},we=Number.isNaN||F.isNaN;function Ce(e){return"number"==typeof e&&!we(e)}var Ae=function(e){return e>0&&e<1/0};function Ee(e){return void 0===e}function _e(e){return"object"===w(e)&&null!==e}var De=Object.prototype.hasOwnProperty;function Me(e){if(!_e(e))return!1;try{var t=e.constructor,i=t.prototype;return t&&i&&De.call(i,"isPrototypeOf")}catch(e){return!1}}function Fe(e){return"function"==typeof e}var Ie=Array.prototype.slice;function Re(e){return Array.from?Array.from(e):Ie.call(e)}function Be(e,t){return e&&Fe(t)&&(Array.isArray(e)||Ce(e.length)?Re(e).forEach((function(i,a){t.call(e,i,a,e)})):_e(e)&&Object.keys(e).forEach((function(i){t.call(e,e[i],i,e)}))),e}var Te=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];return _e(e)&&i.length>0&&i.forEach((function(t){_e(t)&&Object.keys(t).forEach((function(i){e[i]=t[i]}))})),e},ke=/\.\d*(?:0|9){12}\d*$/;function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return ke.test(e)?Math.round(e*t)/t:e}var Pe=/^width|height|left|top|marginLeft|marginTop$/;function Le(e,t){var i=e.style;Be(t,(function(e,t){Pe.test(t)&&Ce(e)&&(e="".concat(e,"px")),i[t]=e}))}function Se(e,t){if(t)if(Ce(e.length))Be(e,(function(e){Se(e,t)}));else if(e.classList)e.classList.add(t);else{var i=e.className.trim();i?i.indexOf(t)<0&&(e.className="".concat(i," ").concat(t)):e.className=t}}function Ue(e,t){t&&(Ce(e.length)?Be(e,(function(e){Ue(e,t)})):e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&(e.className=e.className.replace(t,"")))}function $e(e,t,i){t&&(Ce(e.length)?Be(e,(function(e){$e(e,t,i)})):i?Se(e,t):Ue(e,t))}var Ne=/([a-z\d])([A-Z])/g;function je(e){return e.replace(Ne,"$1-$2").toLowerCase()}function qe(e,t){return _e(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(je(t)))}function He(e,t,i){_e(i)?e[t]=i:e.dataset?e.dataset[t]=i:e.setAttribute("data-".concat(je(t)),i)}var We=/\s\s*/,ze=function(){var e=!1;if(M){var t=!1,i=function(){},a=Object.defineProperty({},"once",{get:function(){return e=!0,t},set:function(e){t=e}});F.addEventListener("test",i,a),F.removeEventListener("test",i,a)}return e}();function Ye(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i;t.trim().split(We).forEach((function(t){if(!ze){var n=e.listeners;n&&n[t]&&n[t][i]&&(r=n[t][i],delete n[t][i],0===Object.keys(n[t]).length&&delete n[t],0===Object.keys(n).length&&delete e.listeners)}e.removeEventListener(t,r,a)}))}function Qe(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i;t.trim().split(We).forEach((function(t){if(a.once&&!ze){var n=e.listeners,o=void 0===n?{}:n;r=function(){delete o[t][i],e.removeEventListener(t,r,a);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];i.apply(e,s)},o[t]||(o[t]={}),o[t][i]&&e.removeEventListener(t,o[t][i],a),o[t][i]=r,e.listeners=o}e.addEventListener(t,r,a)}))}function Ve(e,t,i){var a;return Fe(Event)&&Fe(CustomEvent)?a=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,i),e.dispatchEvent(a)}function Xe(e){var t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ge=F.location,Ke=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Je(e){var t=e.match(Ke);return null!==t&&(t[1]!==Ge.protocol||t[2]!==Ge.hostname||t[3]!==Ge.port)}function Ze(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function et(e){var t=e.rotate,i=e.scaleX,a=e.scaleY,r=e.translateX,n=e.translateY,o=[];Ce(r)&&0!==r&&o.push("translateX(".concat(r,"px)")),Ce(n)&&0!==n&&o.push("translateY(".concat(n,"px)")),Ce(t)&&0!==t&&o.push("rotate(".concat(t,"deg)")),Ce(i)&&1!==i&&o.push("scaleX(".concat(i,")")),Ce(a)&&1!==a&&o.push("scaleY(".concat(a,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function tt(e,t){var i=e.pageX,a=e.pageY,r={endX:i,endY:a};return t?r:y({startX:i,startY:a},r)}function it(e){var t=e.aspectRatio,i=e.height,a=e.width,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",n=Ae(a),o=Ae(i);if(n&&o){var s=i*t;"contain"===r&&s>a||"cover"===r&&s<a?i=a/t:a=i*t}else n?i=a/t:o&&(a=i*t);return{width:a,height:i}}function at(e,t,i,a){var r=t.aspectRatio,n=t.naturalWidth,o=t.naturalHeight,s=t.rotate,l=void 0===s?0:s,c=t.scaleX,h=void 0===c?1:c,u=t.scaleY,d=void 0===u?1:u,p=i.aspectRatio,f=i.naturalWidth,m=i.naturalHeight,v=a.fillColor,g=void 0===v?"transparent":v,b=a.imageSmoothingEnabled,x=void 0===b||b,y=a.imageSmoothingQuality,w=void 0===y?"low":y,C=a.maxWidth,A=void 0===C?1/0:C,E=a.maxHeight,D=void 0===E?1/0:E,M=a.minWidth,F=void 0===M?0:M,I=a.minHeight,R=void 0===I?0:I,B=document.createElement("canvas"),T=B.getContext("2d"),k=it({aspectRatio:p,width:A,height:D}),O=it({aspectRatio:p,width:F,height:R},"cover"),P=Math.min(k.width,Math.max(O.width,f)),L=Math.min(k.height,Math.max(O.height,m)),S=it({aspectRatio:r,width:A,height:D}),U=it({aspectRatio:r,width:F,height:R},"cover"),$=Math.min(S.width,Math.max(U.width,n)),N=Math.min(S.height,Math.max(U.height,o)),j=[-$/2,-N/2,$,N];return B.width=Oe(P),B.height=Oe(L),T.fillStyle=g,T.fillRect(0,0,P,L),T.save(),T.translate(P/2,L/2),T.rotate(l*Math.PI/180),T.scale(h,d),T.imageSmoothingEnabled=x,T.imageSmoothingQuality=w,T.drawImage.apply(T,[e].concat(_(j.map((function(e){return Math.floor(Oe(e))}))))),T.restore(),B}var rt=String.fromCharCode;var nt=/^data:.*,/;function ot(e){var t,i=new DataView(e);try{var a,r,n;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var o=i.byteLength,s=2;s+1<o;){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){r=s;break}s+=1}if(r){var l=r+10;if("Exif"===function(e,t,i){var a="";i+=t;for(var r=t;r<i;r+=1)a+=rt(e.getUint8(r));return a}(i,r+4,4)){var c=i.getUint16(l);if(((a=18761===c)||19789===c)&&42===i.getUint16(l+2,a)){var h=i.getUint32(l+4,a);h>=8&&(n=l+h)}}}if(n){var u,d,p=i.getUint16(n,a);for(d=0;d<p;d+=1)if(u=n+12*d+2,274===i.getUint16(u,a)){u+=8,t=i.getUint16(u,a),i.setUint16(u,1,a);break}}}catch(e){t=1}return t}var st={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,a=this.cropper,r=Number(t.minContainerWidth),n=Number(t.minContainerHeight);Se(a,Q),Ue(e,Q);var o={width:Math.max(i.offsetWidth,r>=0?r:200),height:Math.max(i.offsetHeight,n>=0?n:100)};this.containerData=o,Le(a,{width:o.width,height:o.height}),Se(e,Q),Ue(a,Q)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,a=Math.abs(t.rotate)%180==90,r=a?t.naturalHeight:t.naturalWidth,n=a?t.naturalWidth:t.naturalHeight,o=r/n,s=e.width,l=e.height;e.height*o>e.width?3===i?s=e.height*o:l=e.width/o:3===i?l=e.width/o:s=e.height*o;var c={aspectRatio:o,naturalWidth:r,naturalHeight:n,width:s,height:l};this.canvasData=c,this.limited=1===i||2===i,this.limitCanvas(!0,!0),c.width=Math.min(Math.max(c.width,c.minWidth),c.maxWidth),c.height=Math.min(Math.max(c.height,c.minHeight),c.maxHeight),c.left=(e.width-c.width)/2,c.top=(e.height-c.height)/2,c.oldLeft=c.left,c.oldTop=c.top,this.initialCanvasData=Te({},c)},limitCanvas:function(e,t){var i=this.options,a=this.containerData,r=this.canvasData,n=this.cropBoxData,o=i.viewMode,s=r.aspectRatio,l=this.cropped&&n;if(e){var c=Number(i.minCanvasWidth)||0,h=Number(i.minCanvasHeight)||0;o>1?(c=Math.max(c,a.width),h=Math.max(h,a.height),3===o&&(h*s>c?c=h*s:h=c/s)):o>0&&(c?c=Math.max(c,l?n.width:0):h?h=Math.max(h,l?n.height:0):l&&(c=n.width,(h=n.height)*s>c?c=h*s:h=c/s));var u=it({aspectRatio:s,width:c,height:h});c=u.width,h=u.height,r.minWidth=c,r.minHeight=h,r.maxWidth=1/0,r.maxHeight=1/0}if(t)if(o>(l?0:1)){var d=a.width-r.width,p=a.height-r.height;r.minLeft=Math.min(0,d),r.minTop=Math.min(0,p),r.maxLeft=Math.max(0,d),r.maxTop=Math.max(0,p),l&&this.limited&&(r.minLeft=Math.min(n.left,n.left+(n.width-r.width)),r.minTop=Math.min(n.top,n.top+(n.height-r.height)),r.maxLeft=n.left,r.maxTop=n.top,2===o&&(r.width>=a.width&&(r.minLeft=Math.min(0,d),r.maxLeft=Math.max(0,d)),r.height>=a.height&&(r.minTop=Math.min(0,p),r.maxTop=Math.max(0,p))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=a.width,r.maxTop=a.height},renderCanvas:function(e,t){var i=this.canvasData,a=this.imageData;if(t){var r=function(e){var t=e.width,i=e.height,a=e.degree;if(90==(a=Math.abs(a)%180))return{width:i,height:t};var r=a%90*Math.PI/180,n=Math.sin(r),o=Math.cos(r),s=t*o+i*n,l=t*n+i*o;return a>90?{width:l,height:s}:{width:s,height:l}}({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),n=r.width,o=r.height,s=i.width*(n/i.naturalWidth),l=i.height*(o/i.naturalHeight);i.left-=(s-i.width)/2,i.top-=(l-i.height)/2,i.width=s,i.height=l,i.aspectRatio=n/o,i.naturalWidth=n,i.naturalHeight=o,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,Le(this.canvas,Te({width:i.width,height:i.height},et({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,a=i.naturalWidth*(t.width/t.naturalWidth),r=i.naturalHeight*(t.height/t.naturalHeight);Te(i,{width:a,height:r,left:(t.width-a)/2,top:(t.height-r)/2}),Le(this.image,Te({width:i.width,height:i.height},et(Te({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,a=Number(e.autoCropArea)||.8,r={width:t.width,height:t.height};i&&(t.height*i>t.width?r.height=r.width/i:r.width=r.height*i),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*a),r.height=Math.max(r.minHeight,r.height*a),r.left=t.left+(t.width-r.width)/2,r.top=t.top+(t.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=Te({},r)},limitCropBox:function(e,t){var i=this.options,a=this.containerData,r=this.canvasData,n=this.cropBoxData,o=this.limited,s=i.aspectRatio;if(e){var l=Number(i.minCropBoxWidth)||0,c=Number(i.minCropBoxHeight)||0,h=o?Math.min(a.width,r.width,r.width+r.left,a.width-r.left):a.width,u=o?Math.min(a.height,r.height,r.height+r.top,a.height-r.top):a.height;l=Math.min(l,a.width),c=Math.min(c,a.height),s&&(l&&c?c*s>l?c=l/s:l=c*s:l?c=l/s:c&&(l=c*s),u*s>h?u=h/s:h=u*s),n.minWidth=Math.min(l,h),n.minHeight=Math.min(c,u),n.maxWidth=h,n.maxHeight=u}t&&(o?(n.minLeft=Math.max(0,r.left),n.minTop=Math.max(0,r.top),n.maxLeft=Math.min(a.width,r.left+r.width)-n.width,n.maxTop=Math.min(a.height,r.top+r.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=a.width-n.width,n.maxTop=a.height-n.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&He(this.face,J,i.width>=t.width&&i.height>=t.height?O:T),Le(this.cropBox,Te({width:i.width,height:i.height},et({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ve(this.element,ae,this.getData())}},lt={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,a=t?this.crossOriginUrl:this.url,r=e.alt||"The image to preview",n=document.createElement("img");if(t&&(n.crossOrigin=t),n.src=a,n.alt=r,this.viewBox.appendChild(n),this.viewBoxImage=n,i){var o=i;"string"==typeof i?o=e.ownerDocument.querySelectorAll(i):i.querySelector&&(o=[i]),this.previews=o,Be(o,(function(e){var i=document.createElement("img");He(e,Z,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(i.crossOrigin=t),i.src=a,i.alt=r,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(i)}))}},resetPreview:function(){Be(this.previews,(function(e){var t=qe(e,Z);Le(e,{width:t.width,height:t.height}),e.innerHTML=t.html,function(e,t){if(_e(e[t]))try{delete e[t]}catch(i){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(i){e.dataset[t]=void 0}else e.removeAttribute("data-".concat(je(t)))}(e,Z)}))},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,a=i.width,r=i.height,n=e.width,o=e.height,s=i.left-t.left-e.left,l=i.top-t.top-e.top;this.cropped&&!this.disabled&&(Le(this.viewBoxImage,Te({width:n,height:o},et(Te({translateX:-s,translateY:-l},e)))),Be(this.previews,(function(t){var i=qe(t,Z),c=i.width,h=i.height,u=c,d=h,p=1;a&&(d=r*(p=c/a)),r&&d>h&&(u=a*(p=h/r),d=h),Le(t,{width:u,height:d}),Le(t.getElementsByTagName("img")[0],Te({width:n*p,height:o*p},et(Te({translateX:-s*p,translateY:-l*p},e))))})))}},ct={bind:function(){var e=this.element,t=this.options,i=this.cropper;Fe(t.cropstart)&&Qe(e,oe,t.cropstart),Fe(t.cropmove)&&Qe(e,ne,t.cropmove),Fe(t.cropend)&&Qe(e,re,t.cropend),Fe(t.crop)&&Qe(e,ae,t.crop),Fe(t.zoom)&&Qe(e,fe,t.zoom),Qe(i,le,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&Qe(i,pe,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Qe(i,se,this.onDblclick=this.dblclick.bind(this)),Qe(e.ownerDocument,ce,this.onCropMove=this.cropMove.bind(this)),Qe(e.ownerDocument,he,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&Qe(window,de,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;Fe(t.cropstart)&&Ye(e,oe,t.cropstart),Fe(t.cropmove)&&Ye(e,ne,t.cropmove),Fe(t.cropend)&&Ye(e,re,t.cropend),Fe(t.crop)&&Ye(e,ae,t.crop),Fe(t.zoom)&&Ye(e,fe,t.zoom),Ye(i,le,this.onCropStart),t.zoomable&&t.zoomOnWheel&&Ye(i,pe,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Ye(i,se,this.onDblclick),Ye(e.ownerDocument,ce,this.onCropMove),Ye(e.ownerDocument,he,this.onCropEnd),t.responsive&&Ye(window,de,this.onResize)}},ht={resize:function(){if(!this.disabled){var e,t,i=this.options,a=this.container,r=this.containerData,n=a.offsetWidth/r.width,o=a.offsetHeight/r.height,s=Math.abs(n-1)>Math.abs(o-1)?n:o;if(1!==s)i.restore&&(e=this.getCanvasData(),t=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(Be(e,(function(t,i){e[i]=t*s}))),this.setCropBoxData(Be(t,(function(e,i){t[i]=e*s}))))}},dblclick:function(){var e,t;this.disabled||this.options.dragMode===ie||this.setDragMode((e=this.dragBox,t=z,(e.classList?e.classList.contains(t):e.className.indexOf(t)>-1)?te:ee))},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){t.wheeling=!1}),50),e.deltaY?a=e.deltaY>0?1:-1:e.wheelDelta?a=-e.wheelDelta/120:e.detail&&(a=e.detail>0?1:-1),this.zoom(-a*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(Ce(t)&&1!==t||Ce(i)&&0!==i||e.ctrlKey))){var a,r=this.options,n=this.pointers;e.changedTouches?Be(e.changedTouches,(function(e){n[e.identifier]=tt(e)})):n[e.pointerId||0]=tt(e),a=Object.keys(n).length>1&&r.zoomable&&r.zoomOnTouch?P:qe(e.target,J),ve.test(a)&&!1!==Ve(this.element,oe,{originalEvent:e,action:a})&&(e.preventDefault(),this.action=a,this.cropping=!1,a===k&&(this.cropping=!0,Se(this.dragBox,G)))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var i=this.pointers;e.preventDefault(),!1!==Ve(this.element,ne,{originalEvent:e,action:t})&&(e.changedTouches?Be(e.changedTouches,(function(e){Te(i[e.identifier]||{},tt(e,!0))})):Te(i[e.pointerId||0]||{},tt(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?Be(e.changedTouches,(function(e){delete i[e.identifier]})):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,$e(this.dragBox,G,this.cropped&&this.options.modal)),Ve(this.element,re,{originalEvent:e,action:t}))}}},ut={change:function(e){var t,i=this.options,a=this.canvasData,r=this.containerData,n=this.cropBoxData,o=this.pointers,s=this.action,l=i.aspectRatio,c=n.left,h=n.top,u=n.width,d=n.height,p=c+u,f=h+d,m=0,v=0,g=r.width,b=r.height,x=!0;!l&&e.shiftKey&&(l=u&&d?u/d:1),this.limited&&(m=n.minLeft,v=n.minTop,g=m+Math.min(r.width,a.width,a.left+a.width),b=v+Math.min(r.height,a.height,a.top+a.height));var w=o[Object.keys(o)[0]],C={x:w.endX-w.startX,y:w.endY-w.startY},A=function(e){switch(e){case L:p+C.x>g&&(C.x=g-p);break;case S:c+C.x<m&&(C.x=m-c);break;case N:h+C.y<v&&(C.y=v-h);break;case U:f+C.y>b&&(C.y=b-f)}};switch(s){case T:c+=C.x,h+=C.y;break;case L:if(C.x>=0&&(p>=g||l&&(h<=v||f>=b))){x=!1;break}A(L),(u+=C.x)<0&&(s=S,c-=u=-u),l&&(d=u/l,h+=(n.height-d)/2);break;case N:if(C.y<=0&&(h<=v||l&&(c<=m||p>=g))){x=!1;break}A(N),d-=C.y,h+=C.y,d<0&&(s=U,h-=d=-d),l&&(u=d*l,c+=(n.width-u)/2);break;case S:if(C.x<=0&&(c<=m||l&&(h<=v||f>=b))){x=!1;break}A(S),u-=C.x,c+=C.x,u<0&&(s=L,c-=u=-u),l&&(d=u/l,h+=(n.height-d)/2);break;case U:if(C.y>=0&&(f>=b||l&&(c<=m||p>=g))){x=!1;break}A(U),(d+=C.y)<0&&(s=N,h-=d=-d),l&&(u=d*l,c+=(n.width-u)/2);break;case j:if(l){if(C.y<=0&&(h<=v||p>=g)){x=!1;break}A(N),d-=C.y,h+=C.y,u=d*l}else A(N),A(L),C.x>=0?p<g?u+=C.x:C.y<=0&&h<=v&&(x=!1):u+=C.x,C.y<=0?h>v&&(d-=C.y,h+=C.y):(d-=C.y,h+=C.y);u<0&&d<0?(s=W,h-=d=-d,c-=u=-u):u<0?(s=q,c-=u=-u):d<0&&(s=H,h-=d=-d);break;case q:if(l){if(C.y<=0&&(h<=v||c<=m)){x=!1;break}A(N),d-=C.y,h+=C.y,u=d*l,c+=n.width-u}else A(N),A(S),C.x<=0?c>m?(u-=C.x,c+=C.x):C.y<=0&&h<=v&&(x=!1):(u-=C.x,c+=C.x),C.y<=0?h>v&&(d-=C.y,h+=C.y):(d-=C.y,h+=C.y);u<0&&d<0?(s=H,h-=d=-d,c-=u=-u):u<0?(s=j,c-=u=-u):d<0&&(s=W,h-=d=-d);break;case W:if(l){if(C.x<=0&&(c<=m||f>=b)){x=!1;break}A(S),u-=C.x,c+=C.x,d=u/l}else A(U),A(S),C.x<=0?c>m?(u-=C.x,c+=C.x):C.y>=0&&f>=b&&(x=!1):(u-=C.x,c+=C.x),C.y>=0?f<b&&(d+=C.y):d+=C.y;u<0&&d<0?(s=j,h-=d=-d,c-=u=-u):u<0?(s=H,c-=u=-u):d<0&&(s=q,h-=d=-d);break;case H:if(l){if(C.x>=0&&(p>=g||f>=b)){x=!1;break}A(L),d=(u+=C.x)/l}else A(U),A(L),C.x>=0?p<g?u+=C.x:C.y>=0&&f>=b&&(x=!1):u+=C.x,C.y>=0?f<b&&(d+=C.y):d+=C.y;u<0&&d<0?(s=q,h-=d=-d,c-=u=-u):u<0?(s=W,c-=u=-u):d<0&&(s=j,h-=d=-d);break;case O:this.move(C.x,C.y),x=!1;break;case P:this.zoom(function(e){var t=y({},e),i=0;return Be(e,(function(e,a){delete t[a],Be(t,(function(t){var a=Math.abs(e.startX-t.startX),r=Math.abs(e.startY-t.startY),n=Math.abs(e.endX-t.endX),o=Math.abs(e.endY-t.endY),s=Math.sqrt(a*a+r*r),l=(Math.sqrt(n*n+o*o)-s)/s;Math.abs(l)>Math.abs(i)&&(i=l)}))})),i}(o),e),x=!1;break;case k:if(!C.x||!C.y){x=!1;break}t=Xe(this.cropper),c=w.startX-t.left,h=w.startY-t.top,u=n.minWidth,d=n.minHeight,C.x>0?s=C.y>0?H:j:C.x<0&&(c-=u,s=C.y>0?W:q),C.y<0&&(h-=d),this.cropped||(Ue(this.cropBox,Q),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}x&&(n.width=u,n.height=d,n.left=c,n.top=h,this.action=s,this.renderCropBox()),Be(o,(function(e){e.startX=e.endX,e.startY=e.endY}))}},dt={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Se(this.dragBox,G),Ue(this.cropBox,Q),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Te({},this.initialImageData),this.canvasData=Te({},this.initialCanvasData),this.cropBoxData=Te({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Te(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Ue(this.dragBox,G),Se(this.cropBox,Q)),this},replace:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,Be(this.previews,(function(t){t.getElementsByTagName("img")[0].src=e})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Ue(this.cropper,Y)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Se(this.cropper,Y)),this},destroy:function(){var e=this.element;return e.cropper?(e.cropper=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,a=i.left,r=i.top;return this.moveTo(Ee(e)?e:a+Number(e),Ee(t)?t:r+Number(t))},moveTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(Ce(e)&&(i.left=e,a=!0),Ce(t)&&(i.top=t,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=(e=Number(e))<0?1/(1-e):1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var a=this.options,r=this.canvasData,n=r.width,o=r.height,s=r.naturalWidth,l=r.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&a.zoomable){var c=s*e,h=l*e;if(!1===Ve(this.element,fe,{ratio:e,oldRatio:n/s,originalEvent:i}))return this;if(i){var u=this.pointers,d=Xe(this.cropper),p=u&&Object.keys(u).length?function(e){var t=0,i=0,a=0;return Be(e,(function(e){var r=e.startX,n=e.startY;t+=r,i+=n,a+=1})),{pageX:t/=a,pageY:i/=a}}(u):{pageX:i.pageX,pageY:i.pageY};r.left-=(c-n)*((p.pageX-d.left-r.left)/n),r.top-=(h-o)*((p.pageY-d.top-r.top)/o)}else Me(t)&&Ce(t.x)&&Ce(t.y)?(r.left-=(c-n)*((t.x-r.left)/n),r.top-=(h-o)*((t.y-r.top)/o)):(r.left-=(c-n)/2,r.top-=(h-o)/2);r.width=c,r.height=h,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return Ce(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,Ce(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(Ce(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.imageData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(Ce(e)&&(i.scaleX=e,a=!0),Ce(t)&&(i.scaleY=t,a=!0),a&&this.renderCanvas(!0,!0)),this},getData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.options,a=this.imageData,r=this.canvasData,n=this.cropBoxData;if(this.ready&&this.cropped){e={x:n.left-r.left,y:n.top-r.top,width:n.width,height:n.height};var o=a.width/a.naturalWidth;if(Be(e,(function(t,i){e[i]=t/o})),t){var s=Math.round(e.y+e.height),l=Math.round(e.x+e.width);e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=l-e.x,e.height=s-e.y}}else e={x:0,y:0,width:0,height:0};return i.rotatable&&(e.rotate=a.rotate||0),i.scalable&&(e.scaleX=a.scaleX||1,e.scaleY=a.scaleY||1),e},setData:function(e){var t=this.options,i=this.imageData,a=this.canvasData,r={};if(this.ready&&!this.disabled&&Me(e)){var n=!1;t.rotatable&&Ce(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,n=!0),t.scalable&&(Ce(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,n=!0),Ce(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var o=i.width/i.naturalWidth;Ce(e.x)&&(r.left=e.x*o+a.left),Ce(e.y)&&(r.top=e.y*o+a.top),Ce(e.width)&&(r.width=e.width*o),Ce(e.height)&&(r.height=e.height*o),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?Te({},this.containerData):{}},getImageData:function(){return this.sized?Te({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&Be(["left","top","width","height","naturalWidth","naturalHeight"],(function(i){t[i]=e[i]})),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&Me(e)&&(Ce(e.left)&&(t.left=e.left),Ce(e.top)&&(t.top=e.top),Ce(e.width)?(t.width=e.width,t.height=e.width/i):Ce(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return this.ready&&this.cropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(e){var t,i,a=this.cropBoxData,r=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&Me(e)&&(Ce(e.left)&&(a.left=e.left),Ce(e.top)&&(a.top=e.top),Ce(e.width)&&e.width!==a.width&&(t=!0,a.width=e.width),Ce(e.height)&&e.height!==a.height&&(i=!0,a.height=e.height),r&&(t?a.height=a.width/r:i&&(a.width=a.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=at(this.image,this.imageData,t,e);if(!this.cropped)return i;var a=this.getData(),r=a.x,n=a.y,o=a.width,s=a.height,l=i.width/Math.floor(t.naturalWidth);1!==l&&(r*=l,n*=l,o*=l,s*=l);var c=o/s,h=it({aspectRatio:c,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),u=it({aspectRatio:c,width:e.minWidth||0,height:e.minHeight||0},"cover"),d=it({aspectRatio:c,width:e.width||(1!==l?i.width:o),height:e.height||(1!==l?i.height:s)}),p=d.width,f=d.height;p=Math.min(h.width,Math.max(u.width,p)),f=Math.min(h.height,Math.max(u.height,f));var m=document.createElement("canvas"),v=m.getContext("2d");m.width=Oe(p),m.height=Oe(f),v.fillStyle=e.fillColor||"transparent",v.fillRect(0,0,p,f);var g=e.imageSmoothingEnabled,b=void 0===g||g,x=e.imageSmoothingQuality;v.imageSmoothingEnabled=b,x&&(v.imageSmoothingQuality=x);var y,w,C,A,E,D,M=i.width,F=i.height,I=r,R=n;I<=-o||I>M?(I=0,y=0,C=0,E=0):I<=0?(C=-I,I=0,E=y=Math.min(M,o+I)):I<=M&&(C=0,E=y=Math.min(o,M-I)),y<=0||R<=-s||R>F?(R=0,w=0,A=0,D=0):R<=0?(A=-R,R=0,D=w=Math.min(F,s+R)):R<=F&&(A=0,D=w=Math.min(s,F-R));var B=[I,R,y,w];if(E>0&&D>0){var T=p/o;B.push(C*T,A*T,E*T,D*T)}return v.drawImage.apply(v,[i].concat(_(B.map((function(e){return Math.floor(Oe(e))}))))),m},setAspectRatio:function(e){var t=this.options;return this.disabled||Ee(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,a=this.face;if(this.ready&&!this.disabled){var r=e===ee,n=t.movable&&e===te;e=r||n?e:ie,t.dragMode=e,He(i,J,e),$e(i,z,r),$e(i,K,n),t.cropBoxMovable||(He(a,J,e),$e(a,z,r),$e(a,K,n))}return this}},pt=F.Cropper,ft=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(C(this,e),!t||!xe.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=Te({},ye,Me(i)&&i),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var t,i,a;return t=e,i=[{key:"init",value:function(){var e,t=this.element,i=t.tagName.toLowerCase();if(!t.cropper){if(t.cropper=this,"img"===i){if(this.isImg=!0,e=t.getAttribute("src")||"",this.originalUrl=e,!e)return;e=t.src}else"canvas"===i&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t=this;if(e){this.url=e,this.imageData={};var i=this.element,a=this.options;if(a.rotatable||a.scalable||(a.checkOrientation=!1),a.checkOrientation&&window.ArrayBuffer)if(ge.test(e))be.test(e)?this.read((r=e.replace(nt,""),n=atob(r),o=new ArrayBuffer(n.length),Be(s=new Uint8Array(o),(function(e,t){s[t]=n.charCodeAt(t)})),o)):this.clone();else{var r,n,o,s,l=new XMLHttpRequest,c=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=c,l.onerror=c,l.ontimeout=c,l.onprogress=function(){l.getResponseHeader("content-type")!==me&&l.abort()},l.onload=function(){t.read(l.response)},l.onloadend=function(){t.reloading=!1,t.xhr=null},a.checkCrossOrigin&&Je(e)&&i.crossOrigin&&(e=Ze(e)),l.open("GET",e,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===i.crossOrigin,l.send()}else this.clone()}}},{key:"read",value:function(e){var t=this.options,i=this.imageData,a=ot(e),r=0,n=1,o=1;if(a>1){this.url=function(e,t){for(var i=[],a=new Uint8Array(e);a.length>0;)i.push(rt.apply(null,Re(a.subarray(0,8192)))),a=a.subarray(8192);return"data:".concat(t,";base64,").concat(btoa(i.join("")))}(e,me);var s=function(e){var t=0,i=1,a=1;switch(e){case 2:i=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:a}}(a);r=s.rotate,n=s.scaleX,o=s.scaleY}t.rotatable&&(i.rotate=r),t.scalable&&(i.scaleX=n,i.scaleY=o),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,i=e.crossOrigin,a=t;this.options.checkCrossOrigin&&Je(t)&&(i||(i="anonymous"),a=Ze(t)),this.crossOrigin=i,this.crossOriginUrl=a;var r=document.createElement("img");i&&(r.crossOrigin=i),r.src=a||t,r.alt=e.alt||"The image to crop",this.image=r,r.onload=this.start.bind(this),r.onerror=this.stop.bind(this),Se(r,V),e.parentNode.insertBefore(r,e.nextSibling)}},{key:"start",value:function(){var e=this,t=this.image;t.onload=null,t.onerror=null,this.sizing=!0;var i=F.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(F.navigator.userAgent),a=function(t,i){Te(e.imageData,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i}),e.initialImageData=Te({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(!t.naturalWidth||i){var r=document.createElement("img"),n=document.body||document.documentElement;this.sizingImage=r,r.onload=function(){a(r.width,r.height),i||n.removeChild(r)},r.src=t.src,i||(r.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",n.appendChild(r))}else a(t.naturalWidth,t.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,t=this.options,i=this.image,a=e.parentNode,r=document.createElement("div");r.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var n=r.querySelector(".".concat(B,"-container")),o=n.querySelector(".".concat(B,"-canvas")),s=n.querySelector(".".concat(B,"-drag-box")),l=n.querySelector(".".concat(B,"-crop-box")),c=l.querySelector(".".concat(B,"-face"));this.container=a,this.cropper=n,this.canvas=o,this.dragBox=s,this.cropBox=l,this.viewBox=n.querySelector(".".concat(B,"-view-box")),this.face=c,o.appendChild(i),Se(e,Q),a.insertBefore(n,e.nextSibling),this.isImg||Ue(i,V),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,Se(l,Q),t.guides||Se(l.getElementsByClassName("".concat(B,"-dashed")),Q),t.center||Se(l.getElementsByClassName("".concat(B,"-center")),Q),t.background&&Se(n,"".concat(B,"-bg")),t.highlight||Se(c,X),t.cropBoxMovable&&(Se(c,K),He(c,J,T)),t.cropBoxResizable||(Se(l.getElementsByClassName("".concat(B,"-line")),Q),Se(l.getElementsByClassName("".concat(B,"-point")),Q)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),Fe(t.ready)&&Qe(e,ue,t.ready,{once:!0}),Ve(e,ue)}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Ue(this.element,Q))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],a=[{key:"noConflict",value:function(){return window.Cropper=pt,e}},{key:"setDefaults",value:function(e){Te(ye,Me(e)&&e)}}],i&&A(t.prototype,i),a&&A(t,a),e}();Te(ft.prototype,st,lt,ct,ht,ut,dt);var mt={name:"ImageEditor",props:{hauteurMinImage:{type:Number,default:200},largeurMinImage:{type:Number,default:200},data:{type:Object,default:function(){return{}}}},data:function(){return{canvasData:null,cropBoxData:null,croppedData:null,cropper:null,touched:!1,estErreurTailleImage:!1,estCropConfirme:!1}},mounted:function(){},beforeDestroy:function(){this.stop()},methods:{click:function(e){var t=e.target,i=this.cropper,a=t.getAttribute("data-action")||t.parentElement.getAttribute("data-action");switch(a){case"move":case"crop":i.setDragMode(a);break;case"rotate-left":i.rotate(-90),this.data.touched=!0;break;case"rotate-right":i.rotate(90),this.data.touched=!0;break;case"confirm-crop":this.crop()}},start:function(){var e=this,t=this.data;this.data.touched=!1,this.cropper||(this.cropper=new ft(this.$refs.image,{autoCrop:!1,dragMode:"none",background:!1,viewMode:1,checkOrientation:!0,modal:!1,guides:!0,movable:!1,cropBoxMovable:!0,zoomOnWheel:!0,zoomOnTouch:!0,toggleDragModeOnDblclick:!1,responsive:!0,ready:function(){!e.data.previousUrl&&e.croppedData&&(e.cropper.crop().setData(e.croppedData).setCanvasData(e.canvasData).setCropBoxData(e.cropBoxData),e.croppedData=null,e.canvasData=null,e.cropBoxData=null,e.touched=!1)},crop:function(i){var a=i.detail;a.width>0&&a.height>0&&!t.cropping&&e.update({cropping:!0})}}))},stop:function(){this.cropper&&(this.cropper.destroy(),this.cropper=null)},crop:function(){var e=this.cropper,t=this.data;if(t.cropping){this.croppedData=e.getData(),this.canvasData=e.getCanvasData(),this.cropBoxData=e.getCropBoxData();var i=1,a="image/png"===t.type?{}:{fillColor:"#fff"};this.canvasData.naturalWidth>this.canvasData.naturalHeight?(i=this.canvasData.naturalWidth/this.canvasData.naturalHeight,a.minWidth=this.largeurMinImage*i,a.minHeight=this.hauteurMinImage):(i=this.canvasData.naturalHeight/this.canvasData.naturalWidth,a.minHeight=this.hauteurMinImage*i,a.minWidth=this.largeurMinImage);var r=e.getCroppedCanvas(a);if(r.width<this.largeurMinImage||r.height<this.hauteurMinImage)return void(this.estErreurTailleImage=!0);this.data.touched=!0,this.estErreurTailleImage=!1,this.update({cropped:!0,cropping:!1,previousUrl:t.url,url:r.toDataURL(t.type)}),this.stop()}},activerModeCrop:function(){this.cropper.crop()},creerNouvelleImageSuiteChangements:function(){if(this.data.touched){var e=this.cropper,t=this.data;this.data.cropping&&this.clear(),this.update({url:e.getCroppedCanvas("image/png"===t.type?{}:{fillColor:"#fff"}).toDataURL(t.type)})}},clear:function(){this.estErreurTailleImage=!1,this.data.cropping&&(this.cropper.clear(),this.update({cropping:!1}))},restore:function(){this.data.cropped&&this.update({cropped:!1,previousUrl:"",url:this.data.previousUrl})},reset:function(){this.stop(),this.update({cropped:!1,cropping:!1,loaded:!1,name:"",previousUrl:"",type:"",url:""})},update:function(e){Object.assign(this.data,e)}}};const vt="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function gt(e){return(e,t)=>function(e,t){const i=vt?t.media||"default":e,a=xt[i]||(xt[i]={ids:new Set,styles:[]});if(!a.ids.has(e)){a.ids.add(e);let i=t.source;if(t.map&&(i+="\n/*# sourceURL="+t.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),a.element||(a.element=document.createElement("style"),a.element.type="text/css",t.media&&a.element.setAttribute("media",t.media),void 0===bt&&(bt=document.head||document.getElementsByTagName("head")[0]),bt.appendChild(a.element)),"styleSheet"in a.element)a.styles.push(i),a.element.styleSheet.cssText=a.styles.filter(Boolean).join("\n");else{const e=a.ids.size-1,t=document.createTextNode(i),r=a.element.childNodes;r[e]&&a.element.removeChild(r[e]),r.length?a.element.insertBefore(t,r[e]):a.element.appendChild(t)}}}(e,t)}let bt;const xt={};for(var yt=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"editor"},[i("div",{staticClass:"canvas"},[i("img",{ref:"image",attrs:{alt:e.$t("champs.customfile.altImageAModifier"),src:e.data.url},on:{loadstart:e.start,load:e.start}})]),e._v(" "),e.cropper?i("div",{staticClass:"toolbar",on:{click:e.click}},[e.data.cropping?i("div",[i("button",{staticClass:"nav__button nav__button--danger utd-btn secondaire compact",attrs:{type:"button","data-action":"clear",title:e.$t("champs.customfile.titleBtnAnnulerRecadrerImage")},on:{click:function(t){return e.clear()}}},[i("span",{staticClass:"utd-icone-svg annuler md"})]),e._v(" "),i("button",{staticClass:"utd-btn secondaire compact",attrs:{type:"button","data-action":"confirm-crop",title:e.$t("champs.customfile.titleBtnConfirmerRecadrerImage")}},[i("span",{staticClass:"utd-icone-svg crochet-bleu md"})])]):i("div",[i("button",{staticClass:"toolbar__button utd-btn secondaire compact",attrs:{type:"button","data-action":"crop",title:e.$t("champs.customfile.titleBtnRecadrerImage")},on:{click:function(t){return e.activerModeCrop()}}},[i("span",{staticClass:"utd-icone-svg crop"})]),e._v(" "),i("button",{staticClass:"toolbar__button utd-btn secondaire compact",attrs:{type:"button","data-action":"rotate-left",title:e.$t("champs.customfile.titleBtnTournerImageGauche")}},[i("span",{staticClass:"utd-icone-svg tourner-gauche"})]),e._v(" "),i("button",{staticClass:"toolbar__button utd-btn secondaire compact",attrs:{type:"button","data-action":"rotate-right",title:e.$t("champs.customfile.titleBtnTournerImageDroite")}},[i("span",{staticClass:"utd-icone-svg tourner-droite"})])])]):e._e(),e._v(" "),e.estErreurTailleImage?i("div",{staticClass:"erreur-dimensions",attrs:{role:"alert"}},[e._v(e._s(e.$t("champs.customfile.erreurs.sousTailleMinimale").replace("{0}",e.largeurMinImage)))]):e._e()])},staticRenderFns:[]},(function(e){e&&e("data-v-0275201e_0",{source:".editor[data-v-0275201e]{height:100%;background-color:var(--couleur-fond-gris);padding:8px 8px 0 8px}.canvas[data-v-0275201e]{align-items:center;display:flex;height:100%;justify-content:center}.toolbar[data-v-0275201e]{display:flex;justify-content:center;background-color:var(--couleur-fond-gris);color:#fff;padding:16px;position:relative;width:100%;z-index:2015;margin:0 auto 0 auto}.toolbar>div[data-v-0275201e]{display:flex}.toolbar button[data-v-0275201e]{color:#fff;display:block;font-size:.875rem;height:40px;width:40px;text-align:center;min-width:0;padding:0;margin-right:24px;line-height:1}.toolbar button[data-v-0275201e]:last-of-type{margin-right:0}.dialog-modifier-image .canvas>img[data-v-0275201e],.dialog-modifier-image .cropper-canvas>img[data-v-0275201e]{max-width:100%!important;max-height:400px!important;display:block;margin-left:auto;margin-right:auto}.editor .toolbar .utd-icone-svg[data-v-0275201e]{min-width:24px;height:24px}.erreur-dimensions[data-v-0275201e]{padding-bottom:16px;color:var(--couleur-erreur)}",map:void 0,media:void 0})}),mt,"data-v-0275201e",false,undefined,!1,gt,void 0,void 0),wt=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{class:[e.context.classes.file,{"ordre-affiche":e.context.model.files.length>1}],attrs:{role:"group","aria-label":"Page "+(e.indexeFichier+1)+". "+e.$t("champs.customfile.srGroupeFichier")+e.texteDetailsFichier}},[e.context.model.files.length>1?i("span",{staticClass:"ordre"},[i("span",{staticClass:"monter"},[i("button",{attrs:{disabled:e.estPremierFichier||e.estUploadEnCours,type:"button",title:e.$t("champs.customfile.titleBtnDeplacerFichierVersHaut")},on:{click:function(t){return e.deplacerFichier(e.indexeFichier-1)}}},[i("span",{staticClass:"fleche"})])]),e._v(" "),i("span",{staticClass:"indexe"},[e._v(e._s(e.indexeFichier+1))]),e._v(" "),i("span",{staticClass:"descendre"},[i("button",{attrs:{disabled:e.estDernierFichier||e.estUploadEnCours,type:"button",title:e.$t("champs.customfile.titleBtnDeplacerFichierVersBas")},on:{click:function(t){return e.deplacerFichier(e.indexeFichier+1)}}},[i("span",{staticClass:"fleche"})])])]):e._e(),e._v(" "),i("span",{class:[e.context.classes.fileImagePreview,{"default-preview":e.file.isDefaultPreviewData}]},[e.file.error?i("span",{staticClass:"utd-icone-svg lg erreur"}):e.doitAfficherBoutonModificationImage?i("button",{staticClass:"btn-edition-image",attrs:{id:e.obtenirIdBoutonModification(),type:"button",title:e.$t("champs.customfile.titleBtnModifierImage")},on:{click:function(t){return e.afficherModaleModifierImage(e.file)}}},[i("img",{class:e.context.classes.fileImagePreviewImage,attrs:{src:e.file.previewData,"aria-hidden":"true"}}),e._v(" "),e._m(0)]):e.imagePreview&&e.file.previewData?i("img",{class:e.context.classes.fileImagePreviewImage,attrs:{src:e.file.previewData,"aria-hidden":"true"}}):i("span",{staticClass:"fond-element-chargement"})]),e._v(" "),i("span",{staticClass:"formulate-file-info",attrs:{"aria-hidden":"true"}},[i("span",{class:e.context.classes.fileName,domProps:{textContent:e._s(e.file.name)}}),e._v(" "),e.file.error?i("span",{staticClass:"formulate-file-error",domProps:{textContent:e._s(e.file.error)}}):e._e()]),e._v(" "),i("span",{class:e.context.classes.fileRemove},[e.file.error||e.file.complete&&!e.file.justFinished?i("span",[i("button",{staticClass:"utd-btn avec-icone-gauche tertiaire delete",attrs:{disabled:e.estUploadEnCours,type:"button"},on:{click:e.file.removeFile}},[i("span",{staticClass:"utd-icone-svg poubelle md",attrs:{"aria-hidden":"true"}}),e._v(" "),i("span",[e._v(e._s(e.$t("boutons.supprimer")))]),e._v(" "),i("span",{staticClass:"sr-only"},[e._v(" "+e._s(e.$t("champs.customfile.srBtnSupprimer")))])])]):e.file.progress?i("span",{class:e.context.classes.fileProgress,attrs:{"data-just-finished":e.file.justFinished,"data-is-finished":!e.file.justFinished&&e.file.complete}},[i("span",{class:e.context.classes.fileProgressInner,style:{width:e.file.progress+"%"}})]):e._e()]),e._v(" "),i("utd-dialog",{ref:"dialogModifierImage",staticClass:"dialog-modifier-image",attrs:{titre:e.$t("champs.customfile.titreModaleEditionImage")}},[i("div",{attrs:{slot:"contenu"},slot:"contenu"},[e.editorData.url?i("image-editor",{ref:"editeurImage",attrs:{data:e.editorData,largeurMinImage:e.context.model.options.largeurMinImage,hauteurMinImage:e.context.model.options.hauteurMinImage}}):e._e()],1),e._v(" "),i("div",{attrs:{slot:"pied"},slot:"pied"},[i("button",{staticClass:"utd-btn secondaire compact",attrs:{type:"button"},on:{click:function(t){return e.annulerEditionImage()}}},[e._v(e._s(e.$t("boutons.annuler")))]),e._v(" "),i("button",{staticClass:"utd-btn primaire compact",attrs:{type:"button"},on:{click:function(t){return e.majImageApresEdition()}}},[e._v(e._s(e.$t("boutons.confirmer")))])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"icone-modifier-image"},[t("span",{staticClass:"utd-icone-svg modifier sm"})])}]},(function(e){e&&e("data-v-5d2c5d64_0",{source:".ordre[data-v-5d2c5d64]{display:flex;flex-direction:column;justify-content:center;margin-right:12px;width:20px}.ordre>.descendre[data-v-5d2c5d64],.ordre>.monter[data-v-5d2c5d64]{width:28px;height:24px;display:block}.ordre button[data-v-5d2c5d64]{min-width:0;padding:0;border:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;margin-left:-4px}.ordre button[data-v-5d2c5d64]:hover{opacity:.7}.ordre button[data-v-5d2c5d64]:disabled{opacity:.3}.ordre button[data-v-5d2c5d64]:disabled:hover{opacity:.3;cursor:not-allowed}.ordre .indexe[data-v-5d2c5d64]{text-align:center}.fleche[data-v-5d2c5d64]{display:block;width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent}.monter .fleche[data-v-5d2c5d64]{border-bottom:12px solid #095797}.descendre .fleche[data-v-5d2c5d64]{border-top:12px solid #095797}.btn-edition-image[data-v-5d2c5d64]{min-width:0;padding:0;width:100%;border:0;height:100%;border:1px solid #c5cad2}.icone-modifier-image[data-v-5d2c5d64]{width:28px;height:28px;display:block;position:absolute;border:2px solid #095797;border-radius:4px;background-color:rgba(255,255,255,.7);bottom:4px;right:4px;display:flex;align-items:center;justify-content:center}.btn-edition-image:hover .icone-modifier-image[data-v-5d2c5d64]{background-color:#fff}.btn-edition-image:focus .icone-modifier-image[data-v-5d2c5d64]{box-shadow:0 0 0 2px #89bce5;border-color:var(--couleur-texte-base)}",map:void 0,media:void 0})}),{components:{ImageEditor:yt},props:{file:{type:Object,required:!0},imagePreview:{type:Boolean,default:!1},context:{type:Object,required:!0}},data:function(){return{editorData:{cropped:!1,cropping:!1,loaded:!1,name:"",previousUrl:"",type:"",url:""},image:null}},computed:{estUploadEnCours:function(){return!!this.context.model.files&&this.context.model.files.some((function(e){return!e.complete}))},doitAfficherBoutonModificationImage:function(){return this.imagePreview&&this.file.previewData&&this.file.file&&this.file.file.type.indexOf("image")>=0&&!this.file.error&&this.file.complete&&!this.file.justFinished},texteDetailsFichier:function(){var e=this.file.error?" ".concat(this.file.error):"";return"".concat(this.file.name,".").concat(e)},estPremierFichier:function(){return 0===this.indexeFichier},estDernierFichier:function(){return!!this.context.model.files&&this.indexeFichier===this.context.model.files.length-1},indexeFichier:function(){var e=this,t=this.context.model.files;return t?t.findIndex((function(t){return t.uuid===e.file.uuid})):-1}},mounted:function(){var e=this;this.$refs.dialogModifierImage.addEventListener("apresFermeture",(function(t){e.$refs.editeurImage.reset(),e.editorData.url=null}))},methods:{deplacerFichier:function(e){var t=this.context.model.files.splice(this.indexeFichier,1)[0];this.context.model.files.splice(e,0,t)},obtenirIdBoutonModification:function(){return"btnModifierImage"+this._uid},afficherModaleModifierImage:function(){this.$refs.dialogModifierImage.setAttribute("afficher",!0),this.$refs.dialogModifierImage.setAttribute("idFocus",this.obtenirIdBoutonModification()),this.image=this.file.previewData,this.editorData.url=this.file.previewData,this.editorData.type=this.file.file.type},annulerEditionImage:function(){this.$refs.dialogModifierImage.setAttribute("afficher",!1)},majImageApresEdition:function(){var e=this;this.$refs.editeurImage.creerNouvelleImageSuiteChangements(),this.image!==this.editorData.url?(this.file.previewData=this.editorData.url,fetch(this.editorData.url).then((function(t){t.ok&&t.blob().then((function(t){var i=new File([t],e.file.file.name,{type:e.file.file.type});e.file.file=i,e.file.path=!1,e.file.reuploadFile(),e.$refs.dialogModifierImage.setAttribute("afficher",!1)}))})).catch((function(t){console.log("Il y a eu un problème avec l'opération fetch: "+t.message),e.$refs.dialogModifierImage.setAttribute("afficher",!1)}))):this.$refs.dialogModifierImage.setAttribute("afficher",!1)}}},"data-v-5d2c5d64",false,undefined,!1,gt,void 0,void 0),Ct="-_",At=36;At--;)Ct+=At.toString(36);for(At=36;At---10;)Ct+=At.toString(36).toUpperCase();var Et=function(e){var t="";for(At=e||21;At--;)t+=Ct[64*Math.random()|0];return t};function _t(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Mt(){return Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},Mt.apply(this,arguments)}function Ft(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function It(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(i),!0).forEach((function(t){Dt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ft(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Rt,Bt,Tt,kt=(Rt=function(e){"undefined"!=typeof window&&function(t){var i=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,a=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=a&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),n=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(a||n)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,i,s,l,c,h,u,d,p;if(!(t=e.match(o)))throw new Error("invalid data URI");for(i=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],l=e.slice(t[0].length),c=s?atob(l):decodeURIComponent(l),h=new ArrayBuffer(c.length),u=new Uint8Array(h),d=0;d<c.length;d+=1)u[d]=c.charCodeAt(d);return a?new Blob([r?u:h],{type:i}):((p=new n).append(h),p.getBlob(i))};t.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(e,t,a){var r=this;setTimeout((function(){a&&i.toDataURL&&s?e(s(r.toDataURL(t,a))):e(r.mozGetAsFile("blob",t))}))}:i.toDataURL&&s&&(i.msToBlob?i.toBlob=function(e,t,a){var r=this;setTimeout((function(){(t&&"image/png"!==t||a)&&i.toDataURL&&s?e(s(r.toDataURL(t,a))):e(r.msToBlob(t))}))}:i.toBlob=function(e,t,i){var a=this;setTimeout((function(){e(s(a.toDataURL(t,i)))}))})),e.exports?e.exports=s:t.dataURLtoBlob=s}(window)},Rt(Tt={path:Bt,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&Tt.path)}},Tt.exports),Tt.exports),Ot={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,quality:.8,mimeType:"auto",convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Pt="undefined"!=typeof window&&void 0!==window.document?window:{},Lt=Array.prototype.slice;var St=/^image\/.+$/;function Ut(e){return St.test(e)}var $t=String.fromCharCode;var Nt=Pt.btoa;function jt(e){var t,i=new DataView(e);try{var a,r,n;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var o=i.byteLength,s=2;s+1<o;){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){r=s;break}s+=1}if(r){var l=r+10;if("Exif"===function(e,t,i){var a,r="";for(i+=t,a=t;a<i;a+=1)r+=$t(e.getUint8(a));return r}(i,r+4,4)){var c=i.getUint16(l);if(((a=18761===c)||19789===c)&&42===i.getUint16(l+2,a)){var h=i.getUint32(l+4,a);h>=8&&(n=l+h)}}}if(n){var u,d,p=i.getUint16(n,a);for(d=0;d<p;d+=1)if(u=n+12*d+2,274===i.getUint16(u,a)){u+=8,t=i.getUint16(u,a),i.setUint16(u,1,a);break}}}catch(e){t=1}return t}var qt=/\.\d*(?:0|9){12}\d*$/;function Ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return qt.test(e)?Math.round(e*t)/t:e}var Wt=Pt.ArrayBuffer,zt=Pt.FileReader,Yt=Pt.URL||Pt.webkitURL,Qt=/\.\w+$/,Vt=Pt.Compressor,Xt=function(){function e(t,i){!
/*!
 * Compressor.js v1.0.7
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2020-11-28T07:13:17.754Z
 */
function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file=t,this.image=new Image,this.options=It(It({},Ot),i),this.aborted=!1,this.result=null,this.init()}var t,i,a;return t=e,a=[{key:"noConflict",value:function(){return window.Compressor=Vt,e}},{key:"setDefaults",value:function(e){Mt(Ot,e)}}],(i=[{key:"init",value:function(){var e=this,t=this.file,i=this.options;if(a=t,"undefined"!=typeof Blob&&(a instanceof Blob||"[object Blob]"===Object.prototype.toString.call(a))){var a,r=t.type;if(Ut(r))if(Yt&&zt)if(Wt||(i.checkOrientation=!1),Yt&&!i.checkOrientation)this.load({url:Yt.createObjectURL(t)});else{var n=new zt,o=i.checkOrientation&&"image/jpeg"===r;this.reader=n,n.onload=function(i){var a=i.target.result,n={};if(o){var s=jt(a);s>1||!Yt?(n.url=function(e,t){for(var i,a=[],r=new Uint8Array(e);r.length>0;)a.push($t.apply(null,(i=r.subarray(0,8192),Array.from?Array.from(i):Lt.call(i)))),r=r.subarray(8192);return"data:".concat(t,";base64,").concat(Nt(a.join("")))}(a,r),s>1&&Mt(n,function(e){var t=0,i=1,a=1;switch(e){case 2:i=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:a}}(s))):n.url=Yt.createObjectURL(t)}else n.url=a;e.load(n)},n.onabort=function(){e.fail(new Error("Aborted to read the image with FileReader."))},n.onerror=function(){e.fail(new Error("Failed to read the image with FileReader."))},n.onloadend=function(){e.reader=null},o?n.readAsArrayBuffer(t):n.readAsDataURL(t)}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(e){var t=this,i=this.file,a=this.image;a.onload=function(){t.draw(It(It({},e),{},{naturalWidth:a.naturalWidth,naturalHeight:a.naturalHeight}))},a.onabort=function(){t.fail(new Error("Aborted to load the image."))},a.onerror=function(){t.fail(new Error("Failed to load the image."))},Pt.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Pt.navigator.userAgent)&&(a.crossOrigin="anonymous"),a.alt=i.name,a.src=e.url}},{key:"draw",value:function(e){var t=this,i=e.naturalWidth,a=e.naturalHeight,r=e.rotate,n=void 0===r?0:r,o=e.scaleX,s=void 0===o?1:o,l=e.scaleY,c=void 0===l?1:l,h=this.file,u=this.image,d=this.options,p=document.createElement("canvas"),f=p.getContext("2d"),m=i/a,v=Math.abs(n)%180==90,g=Math.max(d.maxWidth,0)||1/0,b=Math.max(d.maxHeight,0)||1/0,x=Math.max(d.minWidth,0)||0,y=Math.max(d.minHeight,0)||0,w=Math.max(d.width,0)||i,C=Math.max(d.height,0)||a;if(v){var A=[b,g];g=A[0],b=A[1];var E=[y,x];x=E[0],y=E[1];var _=[C,w];w=_[0],C=_[1]}g<1/0&&b<1/0?b*m>g?b=g/m:g=b*m:g<1/0?b=g/m:b<1/0&&(g=b*m),x>0&&y>0?y*m>x?y=x/m:x=y*m:x>0?y=x/m:y>0&&(x=y*m),C*m>w?C=w/m:w=C*m;var D=-(w=Math.floor(Ht(Math.min(Math.max(w,x),g))))/2,M=-(C=Math.floor(Ht(Math.min(Math.max(C,y),b))))/2,F=w,I=C;if(v){var R=[C,w];w=R[0],C=R[1]}p.width=w,p.height=C,Ut(d.mimeType)||(d.mimeType=h.type);var B="transparent";if(h.size>d.convertSize&&"image/png"===d.mimeType&&(B="#fff",d.mimeType="image/jpeg"),f.fillStyle=B,f.fillRect(0,0,w,C),d.beforeDraw&&d.beforeDraw.call(this,f,p),!this.aborted&&(f.save(),f.translate(w/2,C/2),f.rotate(n*Math.PI/180),f.scale(s,c),f.drawImage(u,D,M,F,I),f.restore(),d.drew&&d.drew.call(this,f,p),!this.aborted)){var T=function(e){t.aborted||t.done({naturalWidth:i,naturalHeight:a,result:e})};p.toBlob?p.toBlob(T,d.mimeType,d.quality):T(kt(p.toDataURL(d.mimeType,d.quality)))}}},{key:"done",value:function(e){var t,i,a=e.naturalWidth,r=e.naturalHeight,n=e.result,o=this.file,s=this.image,l=this.options;if(Yt&&!l.checkOrientation&&Yt.revokeObjectURL(s.src),n)if(l.strict&&n.size>o.size&&l.mimeType===o.type&&!(l.width>a||l.height>r||l.minWidth>a||l.minHeight>r))n=o;else{var c=new Date;n.lastModified=c.getTime(),n.lastModifiedDate=c,n.name=o.name,n.name&&n.type!==o.type&&(n.name=n.name.replace(Qt,(t=n.type,"jpeg"===(i=Ut(t)?t.substr(6):"")&&(i="jpg"),".".concat(i))))}else n=o;this.result=n,l.success&&l.success.call(this,n)}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}])&&_t(t.prototype,i),a&&_t(t,a),e}();function Gt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Kt=function(){function e(i,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a(this,e),this.input=i,this.fileList=i.files,this.files=[],this.options=t(t({},{mimes:{}}),n),this.results=!1,this.context=r,this.dataTransferCheck(),r&&r.uploadUrl&&(this.options.uploadUrl=r.uploadUrl),this.uploadPromise=null,Array.isArray(this.fileList)?this.rehydrateFileList(this.fileList):this.addFileList(this.fileList)}return n(e,[{key:"rehydrateFileList",value:function(e){var t=this,i=e.reduce((function(e,i){var a=i[t.options?t.options.fileUrlKey:"url"],r=!(!a||-1===a.lastIndexOf("."))&&a.substr(a.lastIndexOf(".")+1),n=t.options.mimes[r]||!1;return e.push(Object.assign({},i,a?{name:i.name||a.substr(a.lastIndexOf("/")+1||0),type:i.type?i.type:n,previewData:a}:{})),e}),[]);this.addFileList(i),this.results=this.mapUUID(e)}},{key:"addFileList",value:function(e){for(var t=this,i=function(i){var a=e[i],r=Et();t.files.push({progress:!1,error:!1,complete:!1,justFinished:!1,name:a.name||"file-upload",file:a,uuid:r,path:!1,removeFile:function(){this.removeFile(r)}.bind(t),previewData:a.previewData||!1})},a=0;a<e.length;a++)i(a)}},{key:"hasUploader",value:function(){return!!this.context.uploader}},{key:"uploaderIsAxios",value:function(){return!(!this.hasUploader()||"function"!=typeof this.context.uploader.request||"function"!=typeof this.context.uploader.get||"function"!=typeof this.context.uploader.delete||"function"!=typeof this.context.uploader.post)}},{key:"getUploader",value:function(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];if(this.uploaderIsAxios()){var r=new FormData;if(r.append(this.context.name||"file",i[0]),!1===this.context.uploadUrl)throw new Error("No uploadURL specified: https://vueformulate.com/guide/inputs/file/#props");return this.context.uploader.post(this.context.uploadUrl,r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){i[1](Math.round(100*e.loaded/e.total))}}).then((function(e){return e.data})).catch((function(e){return i[2](e)}))}return(e=this.context).uploader.apply(e,i)}},{key:"upload",value:function(){var e=this;return this.uploadPromise=this.uploadPromise?this.uploadPromise.then((function(){return e.__performUpload()})):this.__performUpload(),this.uploadPromise}},{key:"__performUpload",value:function(){var e=this;return new Promise((function(t,i){if(!e.hasUploader())return i(new Error("No uploader has been defined"));Promise.all(e.files.map((function(t){return t.error=!1,t.complete=!!t.path,t.path?Promise.resolve(t.path):e.getUploader(t.file,(function(i){t.progress=i,e.context.rootEmit("file-upload-progress",i),i>=100&&(t.complete||(t.justFinished=!0,setTimeout((function(){t.justFinished=!1}),e.options.uploadJustCompleteDuration)),t.complete=!0,e.context.rootEmit("file-upload-complete",t))}),(function(a){t.progress=0,t.error=a,t.complete=!0,e.context.rootEmit("file-upload-error",a),i(a)}),e.options)}))).then((function(i){e.results=e.mapUUID(i),t(i)})).catch((function(e){throw new Error(e)}))}))}},{key:"removeFile",value:function(e){var t=this.files.length;if(this.files=this.files.filter((function(t){return t&&t.uuid!==e})),Array.isArray(this.results)&&(this.results=this.results.filter((function(t){return t&&t.__id!==e}))),this.context.performValidation(),window&&this.fileList instanceof FileList&&this.supportsDataTransfers){var i=new DataTransfer;this.files.forEach((function(e){return i.items.add(e.file)})),this.fileList=i.files,this.input.files=this.fileList}else this.fileList=this.fileList.filter((function(t){return t&&t.__id!==e}));t>this.files.length&&this.context.rootEmit("file-removed",this.files)}},{key:"mergeFileList",value:function(e){if(this.addFileList(e.files),this.supportsDataTransfers){var t=new DataTransfer;this.files.forEach((function(e){e.file instanceof File&&t.items.add(e.file)})),this.fileList=t.files,this.input.files=this.fileList,e.files=(new DataTransfer).files}this.context.performValidation(),this.loadPreviews(),"delayed"!==this.context.uploadBehavior&&this.upload()}},{key:"loadPreviews",value:function(){this.files.map((function(e){if(!e.previewData&&window&&window.FileReader&&/^image\//.test(e.file.type)){var t=new FileReader;t.onload=function(t){return Object.assign(e,{previewData:t.target.result})},t.readAsDataURL(e.file)}}))}},{key:"dataTransferCheck",value:function(){try{new DataTransfer,this.supportsDataTransfers=!0}catch(e){this.supportsDataTransfers=!1}}},{key:"getFiles",value:function(){return this.files}},{key:"mapUUID",value:function(e){var t=this;return e.map((function(e,i){return t.files[i].path=void 0!==e&&e,e&&(a=e,r=t.files[i].uuid,!Gt(a,"__id")||r?Object.defineProperty(a,"__id",Object.assign(Object.create(null),{value:r||Et(9)})):a);var a,r}))}},{key:"toString",value:function(){var e=this.files.length?this.files.length+" files":"empty";return this.results?JSON.stringify(this.results,null,"  "):"FileUpload(".concat(e,")")}}]),e}(),Jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(r,e);var t=h(r);function r(){return a(this,r),t.apply(this,arguments)}return n(r,[{key:"rehydrateFileList",value:function(e){var t=this,i=e.reduce((function(e,i){var a=i[t.options?t.options.fileUrlKey:"url"],r=!(!a||-1===a.lastIndexOf("."))&&a.substr(a.lastIndexOf(".")+1);r=r.toLowerCase();var n=t.options.mimes[r]||!1;return e.push(Object.assign({},i,a?{name:i.name||a.substr(a.lastIndexOf("/")+1||0),type:i.type?i.type:n,previewData:a,complete:!0,isCompressed:!0}:{})),e}),[]),a=[];i.forEach((function(e){a.push(new Promise((function(i,a){/^image\//.test(e.type)?t.obtenirImageUrlEnBase64(e.previewData).then((function(t){e.previewData=t,i()})).catch((function(t){e.error=t,i()})):(e.previewData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAA7pJREFUeF7t3E9IFFEcB/DfOLn+oTIVUaFLkP2jv3iJOgQdhAWhOkxBRtDFU2FQUBRZbSVBx24dQkPr8CCQHRGng9Ch6CBkutYl0BJ0Td08lP1hd+KVu+jq2Hvvt7POzv726vv+dt5nfzPu29l9GtADJaCh0hQGAkQ2AQFmGzAYDBbF9fXfAEBHPrfb8beWyQ64/SRSHVhf31xYWRv75fZBZbD+oGWy/Rmst6yUFGBDo5EAyLHrpg39Vg876haiLKC9+EDOnW1y67iU6rY/6YIlB7hQRQN43WeyQ0pF/xMSBtxlGIHN8/AzWe/+nZuwc8d2N45Juebxk01g2ysRAmgafOwLs63KxR2CwoDB4IWiuD75I1nnQdtt2FZXl+njQdVbDfBvYQ1eWmF2BPUkaWFfA+7bsxsGh4aXTjnDiL4G7GZP4fqtuzAcGUlHHLXCbEsmOtH3gBzpWmsIIu8/pHu9sUx2EIuYF4AcyaET+60w7i1O3gByxNZQ27Jrog0w9MJke1U7Ma8AnU5nDGLeATpeEzVQOp19BXji1BlIJPhq89+D/xd2etwI3YN3Q5H0P7+yTHZY5nT2FWDz+YsQjU7JzH/ZWNkVi68AucYx4zQKkIctkwm7CA/MhaUcn/zo2CdouXwVhajHa4p7ex+m1v2rFfMdIJ8s/0Ch5dIVGPs8rgSZ94Cyat1mDzzu6ErFCFBSkAAlwdKHEyABIgWQcepAAkQKIOPUgQSIFEDGqQP9DMg/XpqNzYGdWPl+LXLuK8Z1vQAqKjYJl/Z0B05MfhGeSKYH1tZUCZUkQAcmXwBORqcdv24h1B6KgwKBQqgUPI093YGK889qjACR3ARIgEgBZJw6kACRAsg4dSABIgWQcU93IL2RXnh1VW+s01qYAFe9QLj+zYREwobZ2Nfsfpy1ToeK8jLhK6Onr4HCs1jDgQSIxCdAAkQKIOPUgQSIFEDGqQP9DMhva0anZpBTlItrGkB1dZXwL8M93YG0lKOl3Nou5fjpu/jHL3Ino/ro0tJiKNu4QaiAp09hoRms8SACRL4ABEiASAFknDqQAJECyDh1IAEiBZBx6kACRAog49SBBIgUQMaz0oG5sP2dquPz7jB0dD5LxcdLoGiEMaGdOoVvrPPqDY2GpzdgVAHkv19p71y6PYorm04sAObeFqDyqrZlsgLRmFQH5uAmtKIOqXEzE+WBgYFHv0WDUoC8qGEYgbl5+J4D2yCLGiTHxctKoJQJXvuSIWlA2aPy+3gCRL7CBEiASAFk/A9EFhaNHNKZXQAAAABJRU5ErkJggg==",e.isDefaultPreviewData=!0,i())})))})),Promise.all(a).then((function(){t.addFileList(i,!0),t.results=t.mapUUID(e)}))}},{key:"addFileList",value:function(e){for(var t=this,i=function(i){var a=e[i],r=Et();t.files.push({progress:!1,error:a.error||!1,complete:a.complete||!1,isCompressed:a.isCompressed||!1,justFinished:!1,name:a.name||"file-upload",file:a,uuid:r,path:!1,removeFile:function(){this.removeFile(r)}.bind(t),reuploadFile:function(){this.upload()}.bind(t),previewData:a.previewData||!1})},a=0;a<e.length;a++)i(a)}},{key:"removeFile",value:function(e){var t=this.files.length;if(this.files=this.files.filter((function(t){return t&&t.uuid!==e})),Array.isArray(this.results)&&(this.results=this.results.filter((function(t){return t&&t.__id!==e}))),this.context.performValidation(),window&&this.fileList instanceof FileList&&this.supportsDataTransfers){var i=new DataTransfer;this.files.forEach((function(e){!e.error&&e.file&&"File"==typeof e.file&&i.items.add(e.file)})),this.fileList=i.files,this.input.files=this.fileList}else this.fileList=this.fileList.filter((function(t){return t&&t.__id!==e}));t>this.files.length&&(this.notifierLecteurEcran(this.options.i18nTextesCustomFile.texteFichierSupprime),this.context.rootEmit("file-removed",this.files))}},{key:"uploaderIsAxios",value:function(){return!(!this.hasUploader()||"function"!=typeof this.context.uploader.request||"function"!=typeof this.context.uploader.get||"function"!=typeof this.context.uploader.delete||"function"!=typeof this.context.uploader.post)}},{key:"getUploader",value:function(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];if(this.uploaderIsAxios()){var r=new FormData;if(r.append(this.context.name||"file",i[0]),!1===this.context.uploadUrl)throw new Error("No uploadURL specified: https://vueformulate.com/guide/inputs/file/#props");return this.context.uploader.post(this.context.uploadUrl,r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){i[1](Math.round(100*e.loaded/e.total))}}).then((function(e){return e.data})).catch((function(e){return i[2](e)}))}return(e=this.context).uploader.apply(e,i)}},{key:"upload",value:function(){var e=this;return this.uploadPromise=this.uploadPromise?this.uploadPromise.finally((function(){return e.__performUpload()})):this.__performUpload(),this.uploadPromise}},{key:"__performUpload",value:function(){var e=this;return new Promise((function(t,i){if(!e.hasUploader())return i(new Error("No uploader has been defined"));e.notifierLecteurEcran(e.options.i18nTextesCustomFile.texteTraitementEnCours);var a=[];e.files.forEach((function(t){a.push(new Promise((function(i){e.compresserImage(t).finally((function(){t.error=t.error?t.error:"",t.complete=!!t.error||!!t.path,t.error?i():t.path?i(t.path):e.getUploader(t.file,(function(i){t.progress=i,e.context.rootEmit("file-upload-progress",i)}),(function(a){t.progress=100,t.complete=!0,e.context.rootEmit("file-upload-error",a),a.response&&a.response.data&&a.response.data.detail?t.error=a.response.data.detail:(t.error=e.options.i18nTextesCustomFile.echecUpload,e.options.callbackErreur&&e.options.callbackErreur(a.message)),i()}),e.options).then((function(a){t.complete||(t.justFinished=!0,setTimeout((function(){t.justFinished=!1}),e.options.uploadJustCompleteDuration),t.complete=!0),e.context.rootEmit("file-upload-complete",t),i(a)})).catch((function(){i()}))}))})))})),Promise.all(a).then((function(i){e.results=e.mapUUID(i),e.notifierLecteurEcran(e.options.i18nTextesCustomFile.texteTraitementTermine),t(i)}))}))}},{key:"notifierLecteurEcran",value:function(e){var t=document.getElementById("zoneNotificationsLecteurEcran");if(t){t.innerHTML="";var i=document.createElement("span");i.innerText=e,t.appendChild(i),setTimeout((function(){i.remove()}),500)}}},{key:"mergeFileList",value:function(e){if(this.addFileList(e.files),this.supportsDataTransfers){var t=new DataTransfer;this.files.forEach((function(e){e.file instanceof File&&t.items.add(e.file)})),this.fileList=t.files,this.input.files=this.fileList,e.files=(new DataTransfer).files}this.context.performValidation(),this.definirErreursFichiers(),this.loadPreviews(),"delayed"!==this.context.uploadBehavior&&this.upload()}},{key:"loadPreviews",value:function(){this.files.map((function(e){e.error||e.previewData||/^image\//.test(e.file.type)||(Object.assign(e,{previewData:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAA7pJREFUeF7t3E9IFFEcB/DfOLn+oTIVUaFLkP2jv3iJOgQdhAWhOkxBRtDFU2FQUBRZbSVBx24dQkPr8CCQHRGng9Ch6CBkutYl0BJ0Td08lP1hd+KVu+jq2Hvvt7POzv726vv+dt5nfzPu29l9GtADJaCh0hQGAkQ2AQFmGzAYDBbF9fXfAEBHPrfb8beWyQ64/SRSHVhf31xYWRv75fZBZbD+oGWy/Rmst6yUFGBDo5EAyLHrpg39Vg876haiLKC9+EDOnW1y67iU6rY/6YIlB7hQRQN43WeyQ0pF/xMSBtxlGIHN8/AzWe/+nZuwc8d2N45Juebxk01g2ysRAmgafOwLs63KxR2CwoDB4IWiuD75I1nnQdtt2FZXl+njQdVbDfBvYQ1eWmF2BPUkaWFfA+7bsxsGh4aXTjnDiL4G7GZP4fqtuzAcGUlHHLXCbEsmOtH3gBzpWmsIIu8/pHu9sUx2EIuYF4AcyaET+60w7i1O3gByxNZQ27Jrog0w9MJke1U7Ma8AnU5nDGLeATpeEzVQOp19BXji1BlIJPhq89+D/xd2etwI3YN3Q5H0P7+yTHZY5nT2FWDz+YsQjU7JzH/ZWNkVi68AucYx4zQKkIctkwm7CA/MhaUcn/zo2CdouXwVhajHa4p7ex+m1v2rFfMdIJ8s/0Ch5dIVGPs8rgSZ94Cyat1mDzzu6ErFCFBSkAAlwdKHEyABIgWQcepAAkQKIOPUgQSIFEDGqQP9DMg/XpqNzYGdWPl+LXLuK8Z1vQAqKjYJl/Z0B05MfhGeSKYH1tZUCZUkQAcmXwBORqcdv24h1B6KgwKBQqgUPI093YGK889qjACR3ARIgEgBZJw6kACRAsg4dSABIgWQcU93IL2RXnh1VW+s01qYAFe9QLj+zYREwobZ2Nfsfpy1ToeK8jLhK6Onr4HCs1jDgQSIxCdAAkQKIOPUgQSIFEDGqQP9DMhva0anZpBTlItrGkB1dZXwL8M93YG0lKOl3Nou5fjpu/jHL3Ino/ro0tJiKNu4QaiAp09hoRms8SACRL4ABEiASAFknDqQAJECyDh1IAEiBZBx6kACRAog49SBBIgUQMaz0oG5sP2dquPz7jB0dD5LxcdLoGiEMaGdOoVvrPPqDY2GpzdgVAHkv19p71y6PYorm04sAObeFqDyqrZlsgLRmFQH5uAmtKIOqXEzE+WBgYFHv0WDUoC8qGEYgbl5+J4D2yCLGiTHxctKoJQJXvuSIWlA2aPy+3gCRL7CBEiASAFk/A9EFhaNHNKZXQAAAABJRU5ErkJggg=="}),Object.assign(e,{isDefaultPreviewData:!0}))}))}},{key:"definirErreursFichiers",value:function(){var e=this.context.rules.find((function(e){return"mime"===e.ruleName}));if(e)for(var t=0;t<this.files.length;t++)e.args.includes(this.files[t].file.type)||(this.files[t].error=this.options.i18nTextesCustomFile.formatInvalide)}},{key:"compresserImage",value:function(e){var t=this;return new Promise((function(i,a){e.error||e.isCompressed?i():t.compresserFichier(e.file,t.options.largeurResize,t.options.qualite,t.options.largeurMinImage,t.options.largeurMinImage).then((function(r){var n=r[0],o=r[1];t.validerFichier(o,n,e,t.options).then((function(){var t=new File([o],e.file.name,{type:e.file.type});e.file=t,n&&(e.previewData=n),e.isCompressed=!0,i()})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}))}},{key:"compresserFichier",value:function(e,t,i,a,r){return new Promise((function(a,r){/^image\//.test(e.type)?new Xt(e,{quality:i,maxWidth:t,success:function(e){if(window&&window.FileReader){var t=new FileReader;t.onload=function(t){a([t.target.result,e])},t.readAsDataURL(e)}else a([null,e])},error:function(e){console.log("compresserFichier erreur "+e.message),r(e.message)}}):a([null,e])}))}},{key:"obtenirImageUrlEnBase64",value:function(e){var t=this;return new Promise((function(i,a){fetch(t.obtenirUrlImage(e)).then((function(e){e.ok?e.blob().then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){var e=t.result;i(e)}})):a(t.options.i18nTextesCustomFile.fichierInexistant)})).catch((function(e){a(e)}))}))}},{key:"validerFichier",value:function(e,t,i,a){return new Promise((function(r,n){if(Number((e.size/1024/1024).toFixed(2))>Number(a.tailleMaxMbParFichier))i.progress=100,i.error=a.i18nTextesCustomFile.excedeTailleMaximale.replace("{0}",a.tailleMaxMbParFichier),i.complete=!0,n(i.error);else if(t){var o=new Image;o.onload=function(){var e=o.naturalWidth,t=o.naturalHeight;e<Number(a.largeurMinImage)||t<Number(a.hauteurMinImage)?(i.progress=100,i.error=a.i18nTextesCustomFile.sousTailleMinimale.replace("{0}",a.largeurMinImage),i.complete=!0,n(i.error)):r()},o.src=t}else r()}))}},{key:"obtenirDimensionsImage",value:function(e){return new Promise((function(t,a){var r=new Image;r.onload=function(){t({w:i.width,h:i.height})},r.src=e}))}},{key:"obtenirUrlImage",value:function(e){return e?e.startsWith("/")?e:this.options.downloadUrl+e:e}}]),r}(Kt),Zt=Jt,ei=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.fileUploads.length?i("ul",{class:e.context.classes.files},e._l(e.fileUploads,(function(t){return i("li",{key:t.uuid,attrs:{"data-has-error":!!t.error,"data-has-preview":!(!e.imagePreview||!t.previewData)}},[i("FormulateSlot",{attrs:{name:"file",context:e.context,file:t,"image-preview":e.imagePreview}},[i(e.context.slotComponents.file,{tag:"component",attrs:{context:e.context,file:t,"image-preview":e.imagePreview}})],1)],1)})),0):e._e(),e._v(" "),e.isMultiple&&e.context.addLabel?i("label",{class:[e.context.classes.fileAdd,"utd-btn secondaire compact"],attrs:{disabled:e.estUploadEnCours}},[i("span",[e._v(e._s(e.context.addLabel))]),e._v(" "),i("input",{ref:"addFiles",class:[e.context.classes.fileAddInput,"sr-only"],attrs:{type:"file",cle:e.context.attributes.cle,disabled:e.estUploadEnCours,name:e.context.id,"aria-describedby":e.context.attributes["aria-describedby"],multiple:""},on:{change:e.appendFiles}})]):e._e()])},staticRenderFns:[]},undefined,{name:"FormulateFiles2",props:{files:{type:Zt,required:!0},imagePreview:{type:Boolean,default:!0},context:{type:Object,required:!0}},computed:{estUploadEnCours:function(){return this.files.files.some((function(e){return!e.complete}))},fileUploads:function(){return this.files.files||[]},isMultiple:function(){return Gt(this.context.attributes,"multiple")}},watch:{files:function(){this.imagePreview&&this.files.loadPreviews()}},mounted:function(){this.imagePreview&&this.files.loadPreviews()},methods:{appendFiles:function(){var e=this.$refs.addFiles;e.files.length&&this.files.mergeFileList(e)}}},undefined,false,undefined,!1,void 0,void 0,void 0),ti={props:{context:{type:Object,required:!0}},computed:{type:function(){return this.context.type},attributes:function(){this.context.attributes=this.context.attributes||{};var e=this.context.id.lastIndexOf("_");return this.context.attributes.name=e>0?this.context.id.substring(0,e):this.context.id,this.context.attributes},hasValue:function(){return this.context.hasValue}}},ii=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.context.classes.element,attrs:{"data-type":e.context.type,"data-has-files":e.hasFiles}},[i("FormulateSlot",{attrs:{name:"prefix",context:e.context}},[e.context.slotComponents.prefix?i(e.context.slotComponents.prefix,{tag:"component",attrs:{context:e.context}}):e._e()],1),e._v(" "),i("div",{class:e.context.classes.uploadArea,attrs:{"data-has-files":e.hasFiles,role:"group","aria-label":e.hasFiles?e.labelGroupeFichiers:""}},[e.hasFiles?e._e():i("label",{staticClass:"utd-btn secondaire",class:e.context.classes.fileAdd},[i("span",[e._v(e._s(e.context.addLabel))]),e._v(" "),i("input",e._g(e._b({ref:"file",staticClass:"sr-only",attrs:{type:"file"},on:{blur:e.context.blurHandler,change:e.handleFile}},"input",e.attributes,!1),e.$listeners))]),e._v(" "),e.hasFiles?i("FormulateFiles2",{attrs:{files:e.context.model,"image-preview":"preview"===e.context.imageBehavior,context:e.context}}):e._e()],1),e._v(" "),i("FormulateSlot",{attrs:{name:"suffix",context:e.context}},[e.context.slotComponents.suffix?i(e.context.slotComponents.suffix,{tag:"component",attrs:{context:e.context}}):e._e()],1)],1)},staticRenderFns:[]},undefined,{name:"FormulateInputFile2",props:{tailleMaxMbParFichier:{type:Number,default:5},hauteurMinImage:{type:Number,default:800},largeurMinImage:{type:Number,default:800},largeurResize:{type:Number,default:1920},qualite:{type:Number,default:1}},components:{FormulateFiles2:ei},mixins:[ti],data:function(){return{}},computed:{hasFiles:function(){return!!(this.context.model instanceof Zt&&this.context.model.files.length)},labelGroupeFichiers:function(){var e=this.context.visibleValidationErrors.join(" ");return e=e?". ".concat(e):"","".concat(this.context.label).concat(e)}},created:function(){if(Array.isArray(this.context.model)&&"string"==typeof this.context.model[0][this.$formulate.getFileUrlKey()]){var e={files:this.context.model};this.context.model=new Zt(e,this.context,this.obtenirOptions())}},methods:{preventDefault:function(e){"INPUT"!==e.target.tagName&&"file"!==e.target.getAttribute("type")&&(e=e||event).preventDefault()},handleFile:function(){var e=this,t=this.$refs.file;t.files.length&&(this.context.model=new Zt(t,this.context,this.obtenirOptions()),this.$nextTick((function(){return e.attemptImmediateUpload()})))},attemptImmediateUpload:function(){var e=this;"live"===this.context.uploadBehavior&&this.context.model instanceof Zt&&this.context.hasValidationErrors().then((function(t){e.context.model.definirErreursFichiers(),e.context.model.upload()}))},obtenirOptions:function(){return t(t({},this.$formulate.options),{},{tailleMaxMbParFichier:this.tailleMaxMbParFichier,hauteurMinImage:this.hauteurMinImage,largeurMinImage:this.largeurMinImage,largeurResize:this.largeurResize,qualite:this.qualite,i18nTextesCustomFile:t(t({},this._i18n.t("champs.customfile.erreurs")),this._i18n.t("accessibilite"))})}}},undefined,false,undefined,!1,void 0,void 0,void 0),ai=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.context.classes.element,attrs:{"data-type":e.context.type}},[i("FormulateSlot",{attrs:{name:"prefix",context:e.context}},[e.context.slotComponents.prefix?i(e.context.slotComponents.prefix,{tag:"component",attrs:{context:e.context}}):e._e()],1),e._v(" "),e.unite&&e.emplacementUnite.indexOf("gauche")>=0?i("span",{staticClass:"unite gauche"},[e._v(e._s(e.unite))]):e._e(),e._v(" "),i("input",e._g(e._b({directives:[{name:"model",rawName:"v-model.lazy",value:e.context.model,expression:"context.model",modifiers:{lazy:!0}}],attrs:{type:"number",placeholder:e.placeholder,step:e.step,unite:e.unite},domProps:{value:e.context.model},on:{blur:e.context.blurHandler,change:function(t){return e.$set(e.context,"model",t.target.value)}}},"input",e.attributes,!1),e.$listeners)),e._v(" "),e.unite&&e.emplacementUnite.indexOf("droite")>=0?i("span",{staticClass:"unite droite"},[e._v(e._s(e.unite))]):e._e(),e._v(" "),i("FormulateSlot",{attrs:{name:"suffix",context:e.context}},[e.context.slotComponents.suffix?i(e.context.slotComponents.suffix,{tag:"component",attrs:{context:e.context}}):e._e()],1)],1)},staticRenderFns:[]},undefined,{name:"FormulateInputNombre",mixins:[ti],props:{nbDecimales:{type:Number,default:0},unite:{type:String,default:null},texteAccessibiliteUnite:{type:String,default:null},emplacementUnite:{type:String,default:"gauche-droite"}},data:function(){return{placeholder:null,step:null}},created:function(){if(this.nbDecimales){var e="0".repeat(this.nbDecimales);this.placeholder="0,".concat(e),this.context.placeholder=this.placeholder,this.step="."+e.slice(0,-1)+"1"}}},undefined,false,undefined,!1,void 0,void 0,void 0),ri=p({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.context.classes.element,attrs:{"data-type":e.context.type,cle:e.context.attributes.cle,role:"group","aria-labelledby":e.context.id+"_label",name:e.context.id,tabindex:"-1"}},[i("FormulateSlot",{attrs:{name:"prefix",context:e.context}},[e.context.slotComponents.prefix?i(e.context.slotComponents.prefix,{tag:"component",attrs:{context:e.context}}):e._e()],1),e._v(" "),i("FormulateInput",{attrs:{type:"group",name:e.context.name,repeatable:!1},model:{value:e.context.model,callback:function(t){e.$set(e.context,"model",t)},expression:"context.model"}},[i("FormulateInput",{attrs:{name:"ModeSaisie",type:"hidden"}}),e._v(" "),i("FormulateInput",{attrs:{name:"EstValide",type:"hidden"}}),e._v(" "),i("FormulateInput",{attrs:{name:"AdresseComplete",type:"hidden"}}),e._v(" "),i("div",{class:["conteneur-recherche",{"d-none":e.afficherUniquementAdresseComplete}]},[e.rechercheAvecNoCivique?i("div",{class:["conteneur-nocivique-app"]},[i("FormulateInput",{ref:"noCivique",staticClass:"md nocivique",attrs:{name:"NoCivique",label:e.$t("champs.adresse.libelles.noCivique"),type:"text","input-class":["form-control"],validation:"bail|required|matches:/^\\d[a-zA-Z0-9\\s\\/]*$/","validation-messages":{matches:e.$t("champs.adresse.erreurs.noCiviqueInvalide")}}}),e._v(" "),i("FormulateInput",{staticClass:"md",attrs:{name:"Appartement",label:e.$t("champs.adresse.libelles.appartement"),"input-class":["form-control"],type:"text"}})],1):e._e(),e._v(" "),i("FormulateInput",{ref:"codePostalRecherche",class:["md","mb-0",{"d-none":"saisie-manuelle"===e.modeSaisie||"saisie-assistee"===e.modeSaisie&&e.context.model[0].Rue}],attrs:{name:"CodePostalRecherche",label:e.$t("champs.adresse.libelles.codePostal"),type:"text",autocomplete:"postal-code","input-class":["form-control"],validation:"bail|required|codePostal"},on:{change:e.formaterCodePostal},scopedSlots:e._u([{key:"suffix",fn:function(){return[i("button",{staticClass:"utd-btn primaire compact",attrs:{type:"button"},on:{click:e.rechercherRues}},[e._v(e._s(e.$t("champs.adresse.texteBoutonRechercheRue")))])]},proxy:!0}])})],1),e._v(" "),i("div",{class:{"d-none":"recherche"===e.modeSaisie||e.afficherUniquementAdresseComplete}},[i("div",{class:["conteneur-rue",{"mt-32":"saisie-assistee"===e.modeSaisie&&!e.context.model[0].Rue}]},["saisie-assistee"===e.modeSaisie&&e.ruesTrouvees.length>0?i("FormulateInput",{ref:"rue",attrs:{name:"Rue",label:e.$t("champs.adresse.libelles.rue"),type:"select",disabled:1===e.ruesTrouvees.length,placeholder:e.$t("champs.adresse.placeholders.rue"),"input-class":["form-control"],options:e.listeRues,validation:"required"},on:{change:function(t){return e.definirVilleProvince(t,t.target.selectedIndex)}}}):e._e(),e._v(" "),"saisie-assistee"!==e.modeSaisie||e.context.model[0].Rue?e._e():i("div",{staticClass:"instructions-modifier-adresse rue-non-trouvee"},[e.afficherErreurRetourSW||e.afficherErreurAucuneRueTrouvee?i("span",{attrs:{role:"alert"}},[e.afficherErreurRetourSW?i("span",{staticClass:"texte-erreur"},[e._v("\n              "+e._s(e.$t("champs.adresse.erreurs.erreurServiceRecherche"))+"\n            ")]):i("span",{staticClass:"texte-erreur"},[e._v("\n              "+e._s(e.$t("champs.adresse.erreurs.aucuneRueTrouvee"))+"\n            ")])]):e.ruesTrouvees.length>1?i("span",{staticClass:"texte-rue"},[e._v(e._s(e.$t("champs.adresse.texteInstructionsRueNonTrouvee")))]):e._e(),e._v(" "),i("div",{staticClass:"boutons"},[i("button",{staticClass:"utd-btn tertiaire comme-lien",attrs:{type:"button"},on:{click:e.retourModeRecherche}},[e._v(e._s(e.$t("champs.adresse.texteLienNouvelleRecherche")))]),e._v(" "),i("span",{staticClass:"texte-entre-boutons"},[e._v(e._s(e.$t("champs.adresse.texteEntreLiensRechercheEtSaisie")))]),e._v(" "),i("button",{staticClass:"utd-btn tertiaire comme-lien",attrs:{type:"button"},on:{click:e.activerModeSaisieManuelle}},[e._v(e._s(e.$t("champs.adresse.texteLienSaisieManuelle")))])])]),e._v(" "),e.rechercheAvecNoCivique?e._e():i("div",{class:["conteneur-nocivique-app",{"d-none":"saisie-assistee"===e.modeSaisie&&!e.context.model[0].Rue}]},[i("FormulateInput",{ref:"noCivique",staticClass:"md nocivique",attrs:{name:"NoCivique",label:e.$t("champs.adresse.libelles.noCivique"),type:"text","input-class":["form-control"],validation:"bail|required|matches:/^\\d[a-zA-Z0-9\\s\\/]*$/","validation-messages":{matches:e.$t("champs.adresse.erreurs.noCiviqueInvalide")}}}),e._v(" "),i("FormulateInput",{staticClass:"md",attrs:{name:"Appartement",label:e.$t("champs.adresse.libelles.appartement"),"input-class":["form-control"],type:"text"}})],1),e._v(" "),"saisie-manuelle"===e.modeSaisie?i("FormulateInput",{ref:"rueTexte",attrs:{name:"Rue",label:e.$t("champs.adresse.libelles.rue"),type:"text","input-class":["form-control"],validation:"bail|required|max:25,length"}}):e._e()],1),e._v(" "),"saisie-manuelle"===e.modeSaisie?i("div",[i("FormulateInput",{ref:"municipalite",attrs:{name:"Municipalite",label:e.$t("champs.adresse.libelles.ville"),type:"text",autocomplete:"address-level2","input-class":["form-control"],validation:"bail|required|max:26,length"}}),e._v(" "),i("FormulateInput",{ref:"province",staticClass:"lg",attrs:{name:"Province",label:e.$t("champs.adresse.libelles.province"),type:"text",autocomplete:"address-level1","input-class":["form-control"],validation:"bail|required|max:25,length"}}),e._v(" "),i("FormulateInput",{ref:"codePostal",class:["md"],attrs:{name:"CodePostal",label:e.$t("champs.adresse.libelles.codePostal"),type:"text",autocomplete:"postal-code","input-class":["form-control"],validation:"bail|required|codePostal"},on:{change:e.formaterCodePostal}})],1):e._e()]),e._v(" "),"saisie-assistee"===e.modeSaisie&&e.context.model[0].Rue||"saisie-manuelle"===e.modeSaisie||e.afficherUniquementAdresseComplete?i("div",[i("div",{class:["adresse-complete",{erreur:!e.estAdresseCompleteValide}],attrs:{role:"group","aria-labelledby":e.idTexteAdresseComplete}},["saisie-manuelle"===e.modeSaisie||"saisie-assistee"===e.modeSaisie&&e.context.model[0].Rue||e.afficherUniquementAdresseComplete?i("button",{ref:"btnModifier",staticClass:"utd-btn tertiaire compact modifier",attrs:{type:"button",title:e.$t("champs.adresse.titleBoutonNouvelleRecherche")},on:{click:e.retourModeRecherche}},[i("span",{staticClass:"utd-icone-svg nouvelle-recherche",attrs:{"aria-hidden":"true"}})]):e._e(),e._v(" "),i("div",{attrs:{id:e.idTexteAdresseComplete}},[i("span",{staticClass:"libelle"},[i("span",{class:["utd-icone-svg",e.estAdresseCompleteValide?"succes":"avertissement"],attrs:{"aria-hidden":"true"}}),e._v(" "),i("span",{staticClass:"label"},[e._v(e._s(e.libelleAdresseComplete))])]),e._v(" "),i("span",{ref:"adresseComplete",staticClass:"adresse"},[i("span",[e._v(e._s(e.context.model[0].Appartement?e.context.model[0].Appartement+"-":""))]),e._v(" "),i("span",{staticClass:"noCivique"},[e.$refs.noCivique&&e.$refs.noCivique.hasErrors?i("span",[i("a",{staticClass:"champ-erreur",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.donnerFocusChampSelonRef(e.$refs.noCivique)}}},[e._v(e._s(e.$t("champs.adresse.libelles.noCivique")))]),e._v(", ")]):i("span",[e._v(e._s(e.context.model[0].NoCivique)+", ")])]),e._v(" "),i("span",{staticClass:"rue"},[e.$refs.rueTexte&&this.$refs.rueTexte.hasErrors?i("span",[i("span"),i("a",{staticClass:"champ-erreur",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.donnerFocusChampSelonRef(e.$refs.rueTexte)}}},[e._v(e._s(e.$t("champs.adresse.libelles.rue")))]),e._v(", ")]):i("span",[e._v(e._s(e.context.model[0].Rue)+", ")])]),e._v(" "),i("span",{staticClass:"municipalite"},[this.$refs.municipalite&&this.$refs.municipalite.hasErrors?i("span",[i("a",{staticClass:"champ-erreur",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.donnerFocusChampSelonRef(e.$refs.municipalite)}}},[e._v(e._s(e.$t("champs.adresse.libelles.ville")))]),e._v(", ")]):i("span",[e._v(e._s(e.context.model[0].Municipalite)+", ")])]),e._v(" "),i("span",{staticClass:"province"},[e.$refs.province&&this.$refs.province.hasErrors?i("span",[i("a",{staticClass:"champ-erreur",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.donnerFocusChampSelonRef(e.$refs.province)}}},[e._v(e._s(e.$t("champs.adresse.libelles.province")))]),e._v(", ")]):i("span",[e._v(e._s(e.context.model[0].Province)+", ")])]),e._v(" "),i("span",{staticClass:"codePostal"},[e.$refs.codePostal&&e.$refs.codePostal.hasErrors?i("span",[i("a",{staticClass:"champ-erreur",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.donnerFocusChampSelonRef(e.$refs.codePostal)}}},[e._v(e._s(e.$t("champs.adresse.libelles.codePostal")))])]):i("span",[e._v(e._s(e.context.model[0].CodePostal.replace(" "," ")))])])])])])]):e._e(),e._v(" "),e.afficherUniquementAdresseComplete||"saisie-assistee"===e.modeSaisie&&e.context.model[0].Rue?i("div",{staticClass:"saisie-manuelle"},[i("button",{staticClass:"utd-btn tertiaire comme-lien",attrs:{type:"button"},on:{click:e.activerModeSaisieManuelle}},[e._v(e._s(e.$t("champs.adresse.texteLienNeCorrespondPasAdresse")))])]):e._e()],1),e._v(" "),i("FormulateSlot",{attrs:{name:"suffix",context:e.context}},[e.context.slotComponents.suffix?i(e.context.slotComponents.suffix,{tag:"component",attrs:{context:e.context}}):e._e()],1)],1)},staticRenderFns:[]},undefined,{name:"FormulateInputAdresse",mixins:[ti],props:{urlServiceAdresse:{type:String,default:"/api/RIR/RechercherAdresseParCodePostal"},rechercheAvecNoCivique:{type:Boolean,default:!0}},data:function(){return{modeSaisie:"",ruesTrouvees:[],listeRues:[],afficherUniquementAdresseComplete:!1,afficherErreurRetourSW:!1,afficherErreurAucuneRueTrouvee:!1}},mounted:function(){this.context.model&&this.context.model[0]?this.context.model[0].ModeSaisie?(this.modeSaisie=this.context.model[0].ModeSaisie,this.afficherUniquementAdresseComplete=this.context.model[0].EstValide):(this.afficherUniquementAdresseComplete=this.estAdresseCompleteValide,this.$set(this.context.model[0],"CodePostalRecherche",this.context.model[0].CodePostal||""),this.estAdresseCompleteValide?this.modeSaisie="saisie-preremplie":(this.$set(this.context.model[0],"Rue",""),this.$set(this.context.model[0],"Municipalite",""),this.$set(this.context.model[0],"MunicipaliteNomLong",""),this.modeSaisie="recherche")):this.modeSaisie="recherche"},computed:{idTexteAdresseComplete:function(){return"texteAdresseComplete"+this._uid},estAdresseCompleteValide:function(){if(this.context.model&&this.context.model[0]){if(this.$refs.adresseComplete&&(this.context.model[0].AdresseComplete=this.texteAdresseComplete),"saisie-manuelle"===this.modeSaisie)return this.$refs.rueTexte&&!this.$refs.rueTexte.hasErrors&&this.$refs.noCivique&&!this.$refs.noCivique.hasErrors&&this.$refs.municipalite&&!this.$refs.municipalite.hasErrors&&this.$refs.province&&!this.$refs.province.hasErrors&&this.$refs.codePostal&&!this.$refs.codePostal.hasErrors;var e=this.context.model[0],t=!(!e.NoCivique||this.$refs.noCivique&&this.$refs.noCivique.hasErrors),i=!(!e.CodePostal||this.$refs.codePostal&&this.$refs.codePostal.hasErrors);return t&&!!e.Rue&&!!e.Municipalite&&!!e.Province&&i}return!1},libelleAdresseComplete:function(){return this.estAdresseCompleteValide?this._i18n.t("champs.adresse.libelles.adresseComplete"):this._i18n.t("champs.adresse.libelles.adresseIncomplete")},texteAdresseComplete:function(){if(this.context.model&&this.context.model[0]){var e=this.context.model[0],t=e.Appartement?e.Appartement+"-":"";return"".concat(t).concat(e.NoCivique,", ").concat(e.Rue,", ").concat(e.Municipalite,", ").concat(e.Province,", ").concat(e.CodePostal)}return""}},watch:{modeSaisie:function(e){this.context.model&&this.context.model[0]&&(this.context.model[0].ModeSaisie=e)},estAdresseCompleteValide:function(e){this.context.model[0].EstValide=e}},methods:{rechercherRues:function(e){var t=this;if(!this.estChampRechercheManquant()){this.notifierTraitementEnCoursLecteurEcran();var i=e.currentTarget;this.afficherSpinnerBouton(i);var a=this.context.model[0].CodePostalRecherche;this.$set(this.context.model[0],"CodePostal",a),("localhost:8080"===window.location.host?this.obtenirRuesFake(1):this.obtenirRues(a)).then((function(e){t.afficherErreurRetourSW=!1,t.modeSaisie="saisie-assistee",t.ruesTrouvees=e,e.length>0?(t.afficherErreurAucuneRueTrouvee=!1,t.definirChoixRues(),1===t.ruesTrouvees.length?(t.$set(t.context.model[0],"Rue",t.ruesTrouvees[0].rue),t.$set(t.context.model[0],"Municipalite",t.ruesTrouvees[0].municipalite),t.$set(t.context.model[0],"MunicipaliteNomLong",t.ruesTrouvees[0].municipaliteNomLong),t.$set(t.context.model[0],"Province","Québec"),t.context.model[0].EstValide=t.estAdresseCompleteValide):(t.$set(t.context.model[0],"Rue",""),t.$set(t.context.model[0],"Municipalite",""),t.$set(t.context.model[0],"MunicipaliteNomLong","")),t.$nextTick((function(){1!==t.ruesTrouvees.length&&t.donnerFocusChampSelonRef(t.$refs.rue)}))):(t.afficherErreurAucuneRueTrouvee=!0,t.$set(t.context.model[0],"Rue",""),t.$set(t.context.model[0],"Municipalite",""),t.$set(t.context.model[0],"MunicipaliteNomLong",""),t.context.model[0].EstValide=t.estAdresseCompleteValide),t.masquerSpinnerBouton(i),t.notifierTraitementEnCoursLecteurEcran(!0)})).catch((function(){t.modeSaisie="saisie-assistee",t.afficherErreurRetourSW=!0,t.afficherErreurAucuneRueTrouvee=!1,t.$set(t.context.model[0],"Rue",""),t.$set(t.context.model[0],"Municipalite",""),t.$set(t.context.model[0],"MunicipaliteNomLong",""),t.context.model[0].EstValide=t.estAdresseCompleteValide,t.masquerSpinnerBouton(i),t.notifierTraitementEnCoursLecteurEcran(!0)}))}},notifierTraitementEnCoursLecteurEcran:function(e){var t=document.getElementById("zoneNotificationsLecteurEcran");t&&(t.innerHTML=e?this._i18n.t("accessibilite.texteTraitementTermine"):this._i18n.t("accessibilite.texteTraitementEnCours"))},estChampRechercheManquant:function(){var e=!1;return this.$refs.codePostalRecherche.hasErrors&&(this.$refs.codePostalRecherche.behavioralErrorVisibility=!0,e=!0,this.donnerFocusChampSelonRef(this.$refs.codePostalRecherche)),this.rechercheAvecNoCivique&&this.$refs.noCivique.hasErrors&&(this.$refs.noCivique.behavioralErrorVisibility=!0,e=!0,this.donnerFocusChampSelonRef(this.$refs.noCivique)),e},retourModeRecherche:function(){var e=this;this.afficherUniquementAdresseComplete=!1,this.modeSaisie="recherche",this.reinitialiserErreurs(),this.$nextTick((function(){e.rechercheAvecNoCivique?e.donnerFocusChampSelonRef(e.$refs.noCivique):e.donnerFocusChampSelonRef(e.$refs.codePostalRecherche)}))},donnerFocusChampSelonRef:function(e){e&&e.$el.getElementsByClassName("form-control")[0].focus()},obtenirRues:function(e){return e=e.replace(" ",""),fetch("".concat(this.urlServiceAdresse,"/").concat(e)).then((function(e){if(e.ok)return e.json().then((function(e){return e}));throw new Error("Erreur service de recherche")}))},obtenirRuesFake:function(e){return new Promise((function(t){var i=[{rue:"CH MAHEU",municipalite:"COOKSHIRE-EATON",municipaliteNomLong:"COOKSHIRE-EATON-Long",codePostal:"J0B2A0"},{rue:"CH NORTH",municipalite:"COOKSHIRE-EATON",municipaliteNomLong:"COOKSHIRE-EATON-Long",codePostal:"J0B2A0"},{rue:"RTE 251",municipalite:"COOKSHIRE-EATON",municipaliteNomLong:"COOKSHIRE-EATON-Long",codePostal:"J0B2A0"},{rue:"CH BULWER",municipalite:"MARTINVILLE",municipaliteNomLong:"MARTINVILLE-Long",codePostal:"J0B2A0"},{rue:"RUE DE L'EGLISE",municipalite:"MARTINVILLE",municipaliteNomLong:"MARTINVILLE-Long",codePostal:"J0B2A0"}];setTimeout((function(){t(void 0!==e?i.slice(0,e):i)}),1e3)}))},definirVilleProvince:function(e){var t=this,i=this.ruesTrouvees[e.target.selectedIndex-1];this.$set(this.context.model[0],"Municipalite",i.municipalite),this.$set(this.context.model[0],"MunicipaliteNomLong",i.municipaliteNomLong),this.$set(this.context.model[0],"Province","Québec"),this.$nextTick((function(){t.context.model[0].NoCivique||t.donnerFocusChampSelonRef(t.$refs.noCivique)}))},activerModeSaisieManuelle:function(e){var t=this;this.afficherUniquementAdresseComplete=!1,this.modeSaisie="saisie-manuelle",this.$set(this.context.model[0],"MunicipaliteNomLong","");var i=this.context.model[0].NoCivique,a=this.context.model[0].Appartement;this.reinitialiserErreurs(),this.$nextTick((function(){i&&t.$set(t.context.model[0],"NoCivique",i),a&&t.$set(t.context.model[0],"Appartement",a),t.donnerFocusChampSelonRef(t.$refs.noCivique)}))},reinitialiserErreurs:function(){this.$refs.rue&&(this.$refs.codePostalRecherche.behavioralErrorVisibility=!1),this.$refs.codePostal&&(this.$refs.codePostal.behavioralErrorVisibility=!1),this.$refs.municipalite&&(this.$refs.municipalite.behavioralErrorVisibility=!1),this.$refs.province&&(this.$refs.province.behavioralErrorVisibility=!1),this.$refs.noCivique&&(this.$refs.noCivique.behavioralErrorVisibility=!1),this.$refs.rue&&(this.$refs.rue.behavioralErrorVisibility=!1),this.$refs.rueTexte&&(this.$refs.rueTexte.behavioralErrorVisibility=!1)},definirChoixRues:function(){var e=[];this.ruesTrouvees.forEach((function(t){e.push({value:t.rue,label:"".concat(t.rue,", ").concat(t.municipalite)})})),this.listeRues=e},afficherSpinnerBouton:function(e){e.classList.add("utd-traitement-en-cours");0===e.getElementsByClassName("utd-spinner").length&&(e.innerHTML+='<div class="utd-spinner"></div>'),e.disabled=!0},masquerSpinnerBouton:function(e){var t=e.getElementsByClassName("utd-spinner");t.length>0&&t[0].remove(),e.classList.remove("utd-traitement-en-cours"),e.disabled=!1},formaterCodePostal:function(e){var t=this.obtenirValeurChampAFormater(e).replace(/[^a-zA-Z\d]/g,"");this.appliquerFormatageChamp(e,t,{3:" "},!0)},appliquerFormatageChamp:function(e,t,i,a){if(e&&e.currentTarget&&e.currentTarget.value){for(var r="",n=0;n<t.length;n++)r+=(i[n]||"")+t[n];r=a?r.toUpperCase():r,e.currentTarget.value!=r&&(e.currentTarget.value=r,e.stopPropagation(),e.preventDefault(),e.currentTarget.dispatchEvent(new Event("change")))}},obtenirValeurChampAFormater:function(e){return e&&e.currentTarget&&e.currentTarget.value?e.currentTarget.value:""}}},undefined,false,undefined,!1,void 0,void 0,void 0),ni=Object.freeze({__proto__:null,Label:f,ErrorList:m,RepeatableRemove:g,Repeatable:b,FormulateFile2:wt,FileUpload2:Zt,FormulateFiles2:ei,FormulateInputFile2:ii,Editor:yt,FormulateInputNombre:ai,FormulateInputAdresse:ri}),oi=function(e){Object.entries(ni).forEach((function(t){var i=u(t,2),a=i[0],r=i[1];e.component(a,r)}))},si=Object.freeze({__proto__:null,default:oi,Label:f,ErrorList:m,RepeatableRemove:g,Repeatable:b,FormulateFile2:wt,FileUpload2:Zt,FormulateFiles2:ei,FormulateInputFile2:ii,Editor:yt,FormulateInputNombre:ai,FormulateInputAdresse:ri});return Object.entries(si).forEach((function(e){var t=u(e,2),i=t[0],a=t[1];"default"!==i&&(oi[i]=a)})),oi}();